---
title: Airsim ç¬”è®°ï¼šPython API æ€»ç»“
date: 2025-04-13 18:08:04
tags:
    - å¼ºåŒ–å­¦ä¹ 
    - ä»¿çœŸç¯å¢ƒ
categories:
    - é£Ÿç”¨æŒ‡å—
description: |
    âœˆï¸ æ¯”è¾ƒçƒ­é—¨çš„æ— äººæœºå¼ºåŒ–å­¦ä¹ ä»¿çœŸå¹³å°ä¹‹ä¸€
---

> ğŸ“š å°ç”Ÿçš„ç¬”è®°å‚è€ƒè¥¿æ¹–å¤§å­¦å®å­å®‰å¤§ä½¬çš„æ•™ç¨‹ï¼šhttps://www.zhihu.com/column/multiUAV
>
> å¦ï¼šæœ¬æ–‡å†…å®¹å‡åœ¨ Windows æ“ä½œç³»ç»Ÿä¸‹è¿›è¡Œï¼ˆUbuntu ä¸‹çš„ä»¿çœŸç¯å¢ƒæŠ˜è…¾èµ·æ¥æ¯”è¾ƒéº»çƒ¦ ğŸ’¦ï¼‰

## 0. AirSim APIs ç®€ä»‹
---
AirSim å°è£…äº†ä¸€äº› API æ¥å£ï¼Œä½¿ç”¨è¿™äº› API æ¥å£ï¼Œå¯ä»¥ç”¨ç¨‹åºè·Ÿä»¿çœŸè¿›è¡Œäº¤äº’ã€‚ä¾‹å¦‚å¯ä»¥ä½¿ç”¨ API æ¥è·å–å›¾ç‰‡ã€æ— äººæœºçŠ¶æ€ã€æ§åˆ¶æ— äººæœº/è½¦è¾†çš„è¿åŠ¨ç­‰ã€‚

AirSim çš„ API éå¸¸ä¸°å¯Œï¼Œæœ‰å¾ˆå¤šå¯ä»¥è°ƒç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥å°†è¿™äº›åŠŸèƒ½åˆ†æˆä»¥ä¸‹å‡ ç±»ï¼š

- **å›¾åƒç±» API**ï¼šè·å–å„ç§ç±»å‹çš„å›¾åƒã€æ§åˆ¶äº‘å°ç­‰ï¼›
- **æ§åˆ¶ä»¿çœŸè¿è¡Œ**ï¼šå¯ä»¥æ§åˆ¶ä»¿çœŸæš‚åœæˆ–ç»§ç»­ï¼›
- **ç¢°æ’ API**ï¼šè·å–ç¢°æ’ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¢°æ’æ¬¡æ•°ã€ä½ç½®ã€è¡¨é¢ä¿¡æ¯ã€æ¸—é€æ·±åº¦ç­‰ï¼›
- **ç¯å¢ƒæ—¶é—´ API**ï¼šä¸»è¦æ˜¯æ§åˆ¶å¤ªé˜³åœ¨å¤©ç©ºä¸­çš„ä½ç½®ï¼›
- **ç¯å¢ƒå¤©æ°” API**ï¼šæ§åˆ¶ç¯å¢ƒä¸­çš„å¤©æ°”ï¼šä¸‹é›¨ã€é›ªã€ç°å°˜ã€é›¾æ°”ã€é“è·¯æ¹¿æ»‘ç¨‹åº¦ç­‰ï¼›
- **ç¯å¢ƒé£ API**ï¼šæ§åˆ¶ç¯å¢ƒä¸­çš„é£é€Ÿå’Œé£å‘ç­‰ï¼›
- **é›·è¾¾ API**ï¼šæ·»åŠ å’Œæ§åˆ¶ç¯å¢ƒä¸­çš„é›·è¾¾ä¼ æ„Ÿå™¨ï¼›
- **æ— äººæœºæˆ–è½¦è¾†çš„ API**ï¼šæ§åˆ¶è¿åŠ¨ã€è·å–çŠ¶æ€ç­‰

AirSim çš„ API æœ‰ python å’Œ C++ ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„ä¹ æƒ¯ä»»æ„é€‰æ‹©ï¼Œè¿™é‡Œä¸»è¦è®°å½• python çš„ä½¿ç”¨æ–¹å¼ã€‚

åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£… `msgpack-rpc-python` å’Œ `airsim` ä¸¤ä¸ªåº“å³å¯ä½¿ç”¨

```bash
pip install msgpack-rpc-python
pip install airsim
```

## 1. æ§åˆ¶æ— äººæœºçš„èµ·é£å’Œé™è½
---
å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š

```python
import airsim

# connect to the AirSim simulator
client = airsim.MultirotorClient()
client.confirmConnection()

# get control
client.enableApiControl(True)

# unlock
client.armDisarm(True)

# Async methods returns Future. Call join() to wait for task to complete.
client.takeoffAsync().join()
client.landAsync().join()

# lock
client.armDisarm(False)

# release control
client.enableApiControl(False)
```

> åœ¨è¿è¡Œä¸Šé¢è¿™æ®µä»£ç ä¹‹å‰ï¼Œéœ€è¦å…ˆå°† AirSim è¿è¡Œèµ·æ¥ã€‚
> 
> å…ˆå°† `C:\Users\[ç”¨æˆ·å]\Documents\AirSim` è·¯å¾„ä¸‹çš„ `settings.json` æ–‡ä»¶ä¸­çš„ä»¿çœŸæ¨¡å¼æ”¹ä¸ºå¤šæ—‹ç¿¼ï¼Œå¦‚ä¸‹æ‰€ç¤º
>
> ```json
> {
>     "SettingsVersion": 1.2,
>     "SimMode": "Multirotor"
> }
> ```
> 
> ä¿®æ”¹å®Œæˆåï¼Œæ‰“å¼€ä¹‹å‰å®‰è£…å¥½çš„ `LandscapeMountains` ç¯å¢ƒç›®å½•ä¸‹çš„ `LandscapeMountains.sln` æ–‡ä»¶ï¼›Visual Studio ä¸­ï¼Œé€‰æ‹©ç¼–è¾‘æ¨¡å¼ä¸º `Debug Game Editor` å’Œ `win64`ï¼Œç¡®ä¿ `LandscapeMountains` ä¸ºå¯åŠ¨é¡¹ç›®ã€‚
>
> ç„¶åç‚¹å‡» `æœ¬åœ°Windowsè°ƒè¯•å™¨`ï¼Œè¿™æ—¶å°±ä¼šæ‰“å¼€ Unreal Editorï¼›åœ¨ Unreal Editor ä¸­ç‚¹å‡» `æ’­æ”¾(Play)` æŒ‰é’®ï¼Œä»¿çœŸå¼€å§‹è¿è¡Œã€‚
>
> æ— äººæœºåˆå§‹ä½ç½®è®¾ç½®çš„æ˜¯åœ¨ç©ºä¸­ï¼Œæ‰€ä»¥åˆšä¸€ç‚¹å‡»`æ’­æ”¾`æŒ‰é’®æ—¶ï¼Œæ— äººæœºä¼šå‘ä¸‹è½ï¼Œæœ€åè§¦åœ°ï¼ŒåŒæ—¶æœºç¿¼ä¹Ÿä¸€ç›´æ—‹è½¬ã€‚å› ä¸ºæœ‰ä¸¤ä¸ªç‰©ä½“çš„ç¢°æ’ï¼Œæ‰€ä»¥ç”»é¢ä¸­ç»™å‡ºäº†ä¸€ä¸ªç¢°æ’è­¦å‘Šã€‚ï¼ˆåˆå§‹ä½ç½®æ˜¯å¯ä»¥è‡ªå·±è°ƒçš„ï¼‰
>
> æ³¨æ„ï¼Œåœ¨ `LandscapeMountain` è¿™ä¸ªç¯å¢ƒä¸­ï¼Œæ°´é¢å°±æ˜¯ä¸€ä¸ªç‰©ä½“ï¼Œå®ƒè·ŸçŸ³å¤´ã€æ ‘æœ¨ç­‰æœ‰ç›¸åŒçš„ç‰©ç†ç‰¹æ€§ï¼Œæ‰€ä»¥æ— äººæœºä¸ä¼šè½åˆ°æ°´ä¸­ï¼Œè€Œæ˜¯åœ¨ç¡çœ ï¼Œå°±åƒåœ¨å¹³åœ°ä¸Šç€é™†ä¸€æ ·ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªç¯å¢ƒä¸­çš„ä»¿çœŸï¼Œå°±å¯ä»¥æŠŠæ°´é¢å½“åšå¹³åœ°æ¥çœ‹å¾…ã€‚

ä»£ç è¯¦è§£ï¼š

```python
client = airsim.MultirotorClient()
```

ä¸ AirSim å»ºç«‹è¿æ¥ï¼Œå¹¶ä¸”è¿”å›å¥æŸ„ï¼ˆclientï¼‰ï¼Œåé¢çš„æ¯æ¬¡æ“ä½œéœ€è¦ä½¿ç”¨è¿™ä¸ªå¥æŸ„ã€‚

å¦‚æœæ˜¯æ±½è½¦ä»¿çœŸï¼Œä»£ç æ˜¯ï¼š`client = airsim.CarClient()`ï¼›

```python
client.confirmConnection()
```

æ£€æŸ¥é€šä¿¡æ˜¯å¦å»ºç«‹æˆåŠŸï¼Œå¹¶ä¸”ä¼šåœ¨å‘½ä»¤è¡Œä¸­æ‰“å°è¿æ¥æƒ…å†µï¼Œè¿™æ ·å°±å¯ä»¥åˆ¤æ–­ç¨‹åºæ˜¯å¦å’Œ AirSim è¿æ¥æ­£å¸¸ï¼Œå¦‚æœè¿æ¥æ­£å¸¸ä¼šåœ¨å‘½ä»¤è¡Œä¸­æ‰“å°å¦‚ä¸‹ï¼š

```Terminal
Connected!
Client Ver:1 (Min Req: 1), Server Ver:1 (Min Req: 1)
```

```python
client.enableApiControl(True)   # get control
client.enableApiControl(False)  # release control
```

å› ä¸ºå®‰å…¨é—®é¢˜ï¼Œ API æ§åˆ¶é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œé¥æ§å™¨æœ‰å…¨éƒ¨çš„æ§åˆ¶æƒé™ã€‚æ‰€ä»¥å¿…é¡»è¦åœ¨ç¨‹åºä¸­ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥è·å–æ§åˆ¶æƒã€‚é¥æ§å™¨çš„æ“ä½œä¼šæŠ¢å¤º API çš„æ§åˆ¶æƒï¼ŒåŒæ—¶è®© API è·å–çš„æ§åˆ¶æƒå¤±æ•ˆã€‚ä½¿ç”¨ `isApiControlEnabled` å¯æ£€æŸ¥ API æ˜¯å¦å…·æœ‰æ§åˆ¶æƒã€‚

å¯èƒ½ä¼šæœ‰äººé—®ä¸ºä»€ä¹ˆæœ€åç»“æŸçš„æ—¶å€™è¦é‡Šæ”¾æ§åˆ¶æƒï¼Œåæ­£éƒ½æ˜¯ä»¿çœŸï¼Œç»“æŸä»¿çœŸå°±å¥½äº†ã€‚ä½†æ˜¯å®é™…ä¸Š AirSim çš„å¼€å‘äººå‘˜å¸Œæœ›åœ¨ä»¿çœŸä¸­çš„ä»£ç å¯ä»¥ç›´æ¥ç§»åˆ°ç°å®ä¸­ä½¿ç”¨ï¼Œæ‰€ä»¥å¯¹äºç°å®ä¸­çš„å®‰å…¨é—®é¢˜ï¼Œè¿˜æ˜¯å¼€å‘äº†è·å–æ§åˆ¶æƒå’Œé‡Šæ”¾æ§åˆ¶æƒã€è§£é”å’Œä¸Šé”ç­‰ä¸€ç³»åˆ—å®‰å…¨æ“ä½œã€‚

```python
client.takeoffAsync().join()    # èµ·é£
client.landAsync().join()   # é™è½
```

è¿™ä¸¤ä¸ªå‡½æ•°å¯ä»¥è®©æ— äººæœºèµ·é£å’Œé™è½ã€‚

å¾ˆå¤šæ— äººæœºæˆ–è€…æ±½è½¦æ§åˆ¶çš„å‡½æ•°éƒ½æœ‰ `Async` ä½œä¸ºåç¼€ï¼Œè¿™äº›å‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šç«‹å³è¿”å›ï¼Œè¿™æ ·çš„è¯ï¼Œè™½ç„¶ä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä½†æ˜¯ç¨‹åºå¯ä»¥ç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œè€Œä¸ç”¨ç­‰å¾…è¿™ä¸ªå‡½æ•°çš„ä»»åŠ¡åœ¨ä»¿çœŸä¸­æœ‰æ²¡æœ‰æ‰§è¡Œå®Œã€‚

å¦‚æœä½ æƒ³è®©ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œï¼Œåˆ™åªéœ€è¦åœ¨åé¢åŠ ä¸Š `.join()`ã€‚æœ¬ä¾‹å­å°±æ˜¯è®©ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…æ— äººæœºèµ·é£ä»»åŠ¡å®Œæˆï¼Œç„¶åå†æ‰§è¡Œé™è½ä»»åŠ¡ã€‚

æ–°çš„ä»»åŠ¡ä¼šæ‰“æ–­ä¸Šä¸€ä¸ªæ²¡æœ‰æ‰§è¡Œå®Œçš„ä»»åŠ¡ï¼Œæ‰€ä»¥å¦‚æœ `takeoff` å‡½æ•°æ²¡æœ‰åŠ  `.join()`ï¼Œåˆ™æœ€åçš„è¡¨ç°æ˜¯æ— äººæœºè¿˜æ²¡æœ‰èµ·é£å°±é™è½äº†ï¼Œæ— äººæœºæ˜¯ä¸ä¼šèµ·é£çš„ã€‚

> **Python ä¸ AirSim çš„é€šä¿¡æœºåˆ¶**
>
> AirSim API ä½¿ç”¨çš„æ˜¯ `TCP/IP` ä¸­çš„ `msgpack-rpc` åè®®ï¼Œè¿™æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œæ‰€ä»¥å¦‚æœè®¾ç½®æ­£ç¡®ï¼Œå…¶å®å¯ä»¥ç”¨ä¸¤å°ä¸åŒçš„ç”µè„‘æ¥åšä»¿çœŸï¼Œä¸€å°è·‘ AirSim å’Œ Unrealï¼Œå¦ä¸€å°è·‘ python ç¨‹åºã€‚
>
>å½“ AirSim å¼€å§‹ä»¿çœŸçš„æ—¶å€™ï¼Œä¼šæ‰“å¼€ 41451 ç«¯å£ï¼Œå¹¶ç›‘å¬è¿™ä¸ªç«¯å£çš„éœ€æ±‚ã€‚python ç¨‹åºä½¿ç”¨ `msgpack serialization` æ ¼å¼å‘è¿™ä¸ªç«¯å£å‘é€ RPC åŒ…ï¼Œå°±å¯ä»¥ä¸ AirSim è¿›è¡Œé€šä¿¡äº†ã€‚

## 2. æ§åˆ¶å››æ—‹ç¿¼çš„é£è¡Œï¼ˆcore APIï¼‰
---
### 2.1 æ§åˆ¶æ ·ä¾‹
ç¤ºä¾‹ä»£ç ï¼š

```python
import airsim
import time

# connect to the Airsim simulator
client = airsim.MultirotorClient()

client.enableApiControl(True)   # get control
client.armDisarm(True)          # unlock
client.takeoffAsync().join()    # takeoff

# square flight
client.moveToZAsync(-3, 1).join()               # ä¸Šå‡åˆ° 3m é«˜åº¦
client.moveToPositionAsync(5, 0, -3, 1).join()  # é£åˆ°ï¼ˆ5, 0ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(5, 5, -3, 1).join()  # é£åˆ°ï¼ˆ5, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 5, -3, 1).join()  # é£åˆ°ï¼ˆ0, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 0, -3, 1).join()  # é£åˆ°ï¼ˆ0, 0ï¼‰ç‚¹åæ ‡

client.landAsync().join()       # land
client.armDisarm(False)         # lock
client.enableApiControl(False)  # release control
```

ä¸Šé¢è¿™æ®µä»£ç å®ç°çš„æ•ˆæœæ˜¯ï¼š

- ç¬¬ä¸€é˜¶æ®µï¼šèµ·é£
- ç¬¬äºŒé˜¶æ®µï¼šä¸Šå‡åˆ° 3m é«˜åº¦
- ç¬¬ä¸‰é˜¶æ®µï¼šé£æ­£æ–¹å½¢
  - å‘å‰é£ 5mï¼ˆæ²¿ x è½´æ­£æ–¹å‘ï¼‰
  - å‘å³é£ 5m
  - å‘åé£ 5m
  - å‘å·¦é£ 5mï¼Œå›åˆ°èµ·é£ç‚¹
- ç¬¬å››é˜¶æ®µï¼šé™è½

> âš ï¸ æ³¨æ„ï¼Œå¦‚æœä½ çš„ä»¿çœŸåœ¨åˆšå¼€å§‹çš„æ—¶å€™ï¼Œå››æ—‹ç¿¼å¹¶ä¸æ˜¯æ­£å‰æ–¹ï¼Œè¯´æ˜ player start çš„ä½ç½®æ˜¯æœ‰è§’åº¦çš„ï¼Œå°†å…¶æ”¹æˆ 0 å³å¯ã€‚

ä»£ç è¯¦è§£ï¼š

```python
client.moveToZAsync(-3, 1).join()   # é«˜åº¦æ§åˆ¶
```

`moveToAsync(z, velocity)` æ˜¯é«˜åº¦æ§åˆ¶ APIï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯**é«˜åº¦**ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯**é€Ÿåº¦**ã€‚å®ç°çš„æ•ˆæœæ˜¯æ— äººæœºä»¥ 1m/s çš„é€Ÿåº¦é£åˆ° 3m é«˜ã€‚`.join()` åç¼€çš„æ„æ€æ˜¯ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…ç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼è¾¾åˆ° 3m çš„é«˜åº¦ã€‚å¦‚æœä¸åŠ  `.join()` åç¼€ï¼Œåˆ™ä¸ç”¨ç­‰å¾…ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œå‡½æ•°ç›´æ¥è¿”å›ï¼Œç¨‹åºç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚

```python
client.moveToPositionAsync(5, 0, -3, 1).join()  # é£åˆ°ï¼ˆ5, 0ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(5, 5, -3, 1).join()  # é£åˆ°ï¼ˆ5, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 5, -3, 1).join()  # é£åˆ°ï¼ˆ0, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 0, -3, 1).join()  # é£åˆ°ï¼ˆ0, 0ï¼‰ç‚¹åæ ‡
```

`moveToPositionAsync(x, y, z, velocity)` æ˜¯æ°´å¹³ä½ç½®æ§åˆ¶ APIï¼Œ`x, y, z` æ˜¯å…¨å±€åæ ‡ä½ç½®ï¼Œ`velocity` æ˜¯é€Ÿåº¦ã€‚å®ç°çš„æ•ˆæœæ˜¯ä»¥ 1m/s çš„é€Ÿåº¦é£åˆ° (5, 0) ç‚¹ï¼Œ3m é«˜çš„ä½ç½®ã€‚`.join()` åç¼€çš„æ„æ€æ˜¯ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…ç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼åˆ°è¾¾ç›®æ ‡ä½ç½®ç‚¹ï¼ŒåŒæ—¶åˆ°è¾¾è®¾ç½®çš„é«˜åº¦ã€‚å¦‚æœä¸åŠ  `.join()` åç¼€ï¼Œåˆ™ä¸ç”¨ç­‰å¾…ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œå‡½æ•°ç›´æ¥è¿”å›ï¼Œç¨‹åºç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚

### 2.2 å››æ—‹ç¿¼åº•å±‚é£æ§é€šé“ç®€ä»‹
å…³äºå››æ—‹ç¿¼çš„éçº¿æ€§å»ºæ¨¡å’Œåº•å±‚æ§åˆ¶å™¨è®¾è®¡ï¼Œåœ¨åé¢è¯¦ç»†è®²è§£ï¼Œç›®å‰å…ˆç®€å•ä»‹ç»ä¸€ä¸‹å››æ—‹ç¿¼çš„åº•å±‚é£æ§å¯ä»¥æ§åˆ¶ä»€ä¹ˆé‡ã€‚å½“å››æ—‹ç¿¼ä½é€Ÿé£è¡Œæ—¶ï¼Œå…¶åº•å±‚é£æ§å¯ä»¥è§£è€¦ä¸º 3 ä¸ªé€šé“ï¼š
- æ°´å¹³é€šé“
- é«˜åº¦é€šé“
- åèˆªé€šé“

è¿™ 3 ä¸ªé€šé“å¯ä»¥åˆ†åˆ«æ§åˆ¶ï¼Œå¯ä»¥ç†è§£ä¸ºé€šé“ä¹‹é—´ç›¸äº’ä¸ä¼šå½±å“ã€‚æ°´å¹³é€šé“å¯ä»¥æ§åˆ¶å››æ—‹ç¿¼çš„æ°´å¹³ä½ç½®ã€æ°´å¹³é€Ÿåº¦ã€æ°´å¹³å§¿æ€è§’ï¼›é«˜åº¦é€šé“å¯ä»¥æ§åˆ¶å‚ç›´é«˜åº¦ã€å‚ç›´é€Ÿåº¦ã€å‚ç›´åŠ é€Ÿåº¦ï¼›åèˆªé€šé“å¯ä»¥æ§åˆ¶åèˆªè§’åº¦ã€åèˆªè§’é€Ÿåº¦ã€åèˆªè§’åŠ é€Ÿåº¦ã€‚

æœ¬æ–‡ä¾‹å­ç¨‹åºä¸­ `x, y` æ˜¯æ°´å¹³é€šé“çš„æŒ‡ä»¤ï¼Œæ§åˆ¶å››æ—‹ç¿¼æ°´å¹³æ–¹å‘çš„é£è¡Œï¼›`z` æ˜¯é«˜åº¦é€šé“æŒ‡ä»¤ï¼Œæ§åˆ¶å››æ—‹ç¿¼çš„é«˜åº¦ã€‚æœ¬æ–‡ä¾‹å­ç¨‹åºä¸­æ²¡æœ‰åèˆªé€šé“æŒ‡ä»¤ï¼Œé»˜è®¤çš„åèˆªæ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼è‡ªèº«ä¸ä¼šæ°´å¹³æ—‹è½¬ï¼Œå…¶æœå‘å§‹ç»ˆæœå‘å‰æ–¹ã€‚

### 2.3 æ°´å¹³ä½ç½®æ§åˆ¶å‡½æ•°
å‡½æ•°å®šä¹‰

```python
def moveToPositionAsync(
    self,
    x, 
    y,
    z,
    velocity,
    timeout_sec=3e38,
    drivetrain=DrivetrainType.MaxDegreeOfFreedom,
    yaw_mode=YawMode(),
    lookahead=-1,
    adaptive_lookahead=1,
    vehicle_name="",
)
```

è¾“å…¥å‚æ•°åŒ…æ‹¬ï¼š

- x, y, zï¼šä½ç½®åæ ‡ï¼ˆå…¨å±€åæ ‡ç³»-åŒ—ä¸œåœ°ï¼‰
- velocityï¼šé£è¡Œé€Ÿåº¦ï¼ˆm/sï¼‰
- timeout_secï¼šå¦‚æœæ²¡æœ‰ç›¸åº”ï¼Œè¶…æ—¶æ—¶é—´
- drivetrain, yaw_modeï¼šè®¾ç½®é£è¡Œæœå‘æ¨¡å¼å’Œ yaw è§’æ§åˆ¶æ¨¡å¼
- lookahead, adaptive_lookaheadï¼šè®¾ç½®è·¯å¾„é£è¡Œçš„æ—¶å€™çš„ yaw è§’æ§åˆ¶æ¨¡å¼
- vehicle_nameï¼šæ§åˆ¶çš„å››æ—‹ç¿¼çš„åå­—

`x, y, z, velocity` è¿™å››ä¸ªå‚æ•°æ˜¯å¿…é¡»è¦è®¾ç½®çš„é‡ï¼ŒæŒ‡ç¤ºå››æ—‹ç¿¼ä»¥å¤šå¤§çš„é€Ÿåº¦é£å¾€å“ªä¸ªåæ ‡ç‚¹ã€‚åé¢çš„å‡ ä¸ªå‚æ•°éƒ½æœ‰å…¶é»˜è®¤å€¼ï¼Œä¸ç”¨è®¾ç½®ä¹Ÿå¯ä»¥ã€‚

`lookahead` å’Œ `adaptive_lookahead` è¿™ä¸¤ä¸ªå‚æ•°æ˜¯è®¾ç½®å½“å››æ—‹ç¿¼é£è½¨è¿¹çš„æ—¶å€™çš„æœå‘ï¼Œç›®å‰è¿˜ç”¨ä¸åˆ°ã€‚

`vehicle_name` æ˜¯æŒ‡å°†æŒ‡ä»¤å‘é€ç»™å“ªä¸ªå››æ—‹ç¿¼ï¼Œå½“åšå¤šä¸ªå››æ—‹ç¿¼ååŒé£è¡Œæ§åˆ¶çš„æ—¶å€™ï¼Œè¿™ä¸ªå‚æ•°å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œåé¢ä¼šæœ‰å¤šæœºååŒç¼–é˜Ÿçš„å†…å®¹ã€‚

`drivetrain` å’Œ `yaw_mode` è¿™ä¸¤ä¸ªå‚æ•°çš„ç»„åˆå¯ä»¥è®¾ç½®å››æ—‹ç¿¼çš„åèˆªè§’æ§åˆ¶æ¨¡å¼ï¼Œä¸‹é¢è¯¦ç»†ä»‹ç»ã€‚

### 2.4 åèˆªè§’æ§åˆ¶æ¨¡å¼è¯¦è§£

drivetrain å‚æ•°å¯ä»¥è®¾ç½®ä¸ºä¸¤ä¸ªé‡ï¼š
- `airsim.DrivetrainType.ForwardOnly`ï¼šå§‹ç»ˆæœå‘é€Ÿåº¦æ–¹å‘
- `airsim.DrivetrainType.MaxDegreeOfFreedom`ï¼šæ‰‹åŠ¨è®¾ç½® yaw è§’åº¦

`yaw_mode` å¿…é¡»è®¾ç½®ä¸º `YawMode()` ç±»å‹çš„å˜é‡ï¼Œè¿™ä¸ªç»“æ„ä½“ç±»å‹åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š

- `YawMode().is_rate`ï¼šTrue - è®¾ç½®è§’é€Ÿåº¦ï¼›False - è®¾ç½®è§’åº¦ã€‚
- `YawMode().yaw_or_rate`ï¼šå¯ä»¥æ˜¯ä»»æ„æµ®ç‚¹æ•°

ä¸‹é¢åˆ†å‡ ç§æƒ…å†µè®¨è®ºï¼š

#### æƒ…å†µ1ï¼ˆä¸å…è®¸ï¼‰
```python
drivetrain = airsim.DrivetrainType.ForwardOnly
yaw_mode = airsim.YawMode(True, 0)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```
å½“ `drivetrain = airsim.DrivetrainType.ForwardOnly` æ—¶ï¼Œå››æ—‹ç¿¼å§‹ç»ˆæœå‘å…¶é£è¡Œçš„æ–¹å‘ï¼Œè¿™æ—¶ `yaw_mode` ä¸å…è®¸è®¾ç½®ä¸º `YawMode().is_rate = True`ã€‚å› ä¸ºå‰é¢çš„å‚æ•°è¦æ±‚å››æ—‹ç¿¼æœå‘è¿åŠ¨æ–¹å‘ï¼Œè€Œ `yaw_mode` è¦æ±‚å››æ—‹ç¿¼ä»¥ä¸€å®šçš„è§’é€Ÿåº¦æ—‹è½¬ï¼Œè¿™æ˜¯çŸ›ç›¾çš„ã€‚

#### æƒ…å†µ2
```python
drivetrain = airsim.DrivetrainType.ForwardOnly
yaw_mode = airsim.YawMode(False, 90)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```
è¿™ç§æƒ…å†µä¸‹ï¼Œå››æ—‹ç¿¼çš„æœå‘å§‹ç»ˆä¸å‰è¿›æ–¹å‘ç›¸å·® 90 åº¦ï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼å§‹ç»ˆå‘å·¦ä¾§æ–¹å‘è¿åŠ¨ã€‚ä¾‹å¦‚ï¼šå½“å››æ—‹ç¿¼åœ¨ç»•ç€ä¸€ä¸ªåœ†å¿ƒè½¬åœˆæ—¶ï¼Œå…¶æœå‘å§‹ç»ˆæŒ‡å‘åœ†å¿ƒï¼ˆè¿™ç§é£è¡ŒçŠ¶æ€çš„ä»£ç åœ¨åé¢ç»™å‡ºï¼‰ã€‚è¿™é‡Œçš„ 90 åº¦å¯ä»¥ä»»æ„è®¾ç½®ã€‚

#### æƒ…å†µ3
```python
drivetrain = airsim.DrivetrainType.MaxDegreeOfFreedom
yaw_mode = airsim.YawMode(False, 0)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```
è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ç®¡é€Ÿåº¦æ–¹å‘æ˜¯ä»€ä¹ˆï¼Œå››æ—‹ç¿¼çš„ yaw è§’å§‹ç»ˆç­‰äº 0ï¼Œä¹Ÿå°±æ˜¯å…¶æœå‘å§‹ç»ˆæŒ‡å‘æ­£åŒ—æ–¹å‘ã€‚å¦‚æœæ˜¯ 90 åº¦ï¼Œåˆ™å§‹ç»ˆæŒ‡å‘æ­£ä¸œæ–¹å‘ï¼Œè€Œ -90 åº¦ï¼Œåˆ™å§‹ç»ˆæŒ‡å‘æ­£è¥¿æ–¹å‘ã€‚

#### æƒ…å†µ4
```python
drivetrain = airsim.DrivetrainType.MaxDegreeOfFreedom
yaw_mode = airsim.YawMode(True, 10)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```

è¿™ç§æƒ…å†µä¸‹ï¼Œå››æ—‹ç¿¼ä¸ç®¡é€Ÿåº¦æ–¹å‘æ˜¯ä»€ä¹ˆï¼Œyaw è§’ä»¥ 10 åº¦/ç§’çš„é€Ÿåº¦æ—‹è½¬ã€‚

ä¸‹é¢æ€»ç»“ä¸€ä¸‹è¿™ä¸¤ä¸ªå‚æ•°çš„è®¾ç½®å¯¹æ•ˆæœçš„å½±å“ï¼š

||ForwardOnly|MaxDegreeOfFreedom|
|---|---|---|
|is_rate=True|ä¸å…è®¸|yaw è§’ä»¥ yaw_or_rate åº¦/ç§’æ—‹è½¬|
|is_rate=False|yaw è§’ç›¸å¯¹äºé€Ÿåº¦æ–¹å‘åå·® yaw_or_rate åº¦|yaw è§’ç›¸å¯¹æ­£åŒ—æ–¹å‘åå·® yaw_or_rate åº¦|

> **AirSim åæ ‡ç³»å®šä¹‰**
>
> ä¸ºä»€ä¹ˆ 0 åº¦æ˜¯æ­£åŒ—æ–¹å‘å‘¢ï¼Œè¿™å°±æ¶‰åŠåˆ°åæ ‡ç³»çš„å®šä¹‰äº†ï¼Œä¸‹é¢å…ˆç®€å•ä»‹ç»ä¸€ä¸‹åæ ‡ç³»çš„å®šä¹‰
>
> Unreal å¼•æ“ä¸­çš„åæ ‡ç³»ä¸ AirSim å®šä¹‰çš„åæ ‡ç³»æ˜¯ä¸åŒçš„ï¼Œç”šè‡³é•¿åº¦å•ä½éƒ½ä¸åŒã€‚Unreal çš„é•¿åº¦å•ä½æ˜¯å˜ç±³ï¼Œè€Œ AirSim çš„é•¿åº¦å•ä½æ˜¯ç±³ã€‚ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼ŒAirSim å·²ç»éå¸¸å¥½åœ°å¤„ç†äº†è¿™ä¸ªé—®é¢˜ï¼Œä½ ä¸ç”¨åœ¨æ„ Unreal çš„åæ ‡ç³»æ˜¯ä»€ä¹ˆï¼Œåªéœ€è¦æŒ‰ç…§ AirSim çš„åæ ‡ç³»è®¾ç½®å³å¯ï¼ŒAirSim ä¼šå¸®ä½ è‡ªåŠ¨è½¬æ¢çš„ã€‚
>
> æœ¬æ–‡å…ˆè¯´æ˜ä¸¤ä¸ªåæ ‡ç³»çš„å®šä¹‰ï¼š**å…¨å±€åæ ‡ç³»ã€æœºä½“åæ ‡ç³»**ã€‚
>
> **å…¨å±€åæ ‡ç³»**æ˜¯å›ºè¿åˆ°å¤§åœ°çš„ï¼Œx, y, z ä¸‰ä¸ªåæ ‡è½´çš„æŒ‡å‘åˆ†åˆ«æ˜¯åŒ—ã€ä¸œã€åœ°ï¼Œä¹Ÿå°±æ˜¯æœåŒ—æ˜¯ x è½´çš„æ­£æ–¹å‘ï¼Œæœå—æ˜¯ x è½´çš„è´Ÿæ–¹å‘ã€‚å…¨å±€åæ ‡ç³»çš„åŸç‚¹ä½ç½®æ˜¯å¤§åœ°çš„æŸä¸€ç‚¹ï¼ˆå¯ä»¥åœ¨ settings æ–‡ä»¶ä¸­è®¾ç½®ï¼‰ã€‚
>
> **æœºä½“åæ ‡ç³»**æ˜¯å›ºè¿åˆ°å››æ—‹ç¿¼æœºèº«çš„ï¼Œx, y, z ä¸‰ä¸ªåæ ‡è½´çš„æŒ‡å‘åˆ†åˆ«æ˜¯å‰ã€å³ã€ä¸‹ï¼Œä¹Ÿå°±æ˜¯é£æœºçš„å‰æ–¹æ˜¯ x è½´çš„æ­£æ–¹å‘ï¼Œé£æœºåæ–¹æ˜¯ x è½´çš„è´Ÿæ–¹å‘ã€‚æœºä½“åæ ‡ç³»çš„åŸç‚¹ä½ç½®æ˜¯æœºä½“çš„é‡å¿ƒä½ç½®ã€‚

## 3. é€Ÿåº¦æ§åˆ¶
---

### 3.1 æ§åˆ¶æ ·ä¾‹
è€æ ·å­ï¼Œå…ˆä¸Šç¤ºä¾‹ï¼š

```python
import airsim
import time

client = airsim.MultirotorClient()  # connect to the AirSim simulator
client.enableApiControl(True)       # è·å¾—æ§åˆ¶æƒ
client.armDisarm(True)              # è§£é”
client.takeoffAsync().join()        # ç¬¬ä¸€é˜¶æ®µï¼šèµ·é£

client.moveToZAsync(-2, 1).join()   # ç¬¬äºŒé˜¶æ®µï¼šä¸Šå‡åˆ° 2m é«˜åº¦

# é£æ­£æ–¹å½¢
client.moveByVelocityZAsync(1, 0, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘å‰é£ 8 ç§’é’Ÿ
client.moveByVelocityZAsync(0, 1, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘å³é£ 8 ç§’é’Ÿ
client.moveByVelocityZAsync(-1, 0, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘åé£ 8 ç§’é’Ÿ
client.moveByVelocityZAsync(0, -1, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘å·¦é£ 8 ç§’é’Ÿ

# æ‚¬åœ 2 ç§’é’Ÿ
client.hoverAsync().join()      # ç¬¬å››é˜¶æ®µï¼šæ‚¬åœ 6 ç§’
time.sleep(6)

client.landAsync().join()       # ç¬¬äº”é˜¶æ®µï¼šé™è½
client.armDisarm(False)         # ä¸Šé”
client.enableApiControl(False)  # é‡Šæ”¾æ§åˆ¶æƒ
```

> åœ¨è§†é¢‘æ¼”ç¤ºçš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®å›ºå®šè§†è§’æ¥è§‚å¯Ÿå››æ—‹ç¿¼è¿åŠ¨çš„è½¨è¿¹ï¼Œæ–¹æ³•å¦‚ä¸‹ã€‚
>
> ç‚¹å‡» `è¿è¡Œ/Play` æŒ‰é’®åï¼Œä¸­é—´çš„è§†è§’é»˜è®¤æ˜¯è·Ÿéšè§†è§’ï¼Œè§†è§’çš„è®¾ç½®å†³å®šäº†æ‘„åƒæœºå¦‚ä½•è·Ÿéšå››æ—‹ç¿¼ï¼Œå¯¹äºå››æ—‹ç¿¼æ¥è¯´ï¼Œé»˜è®¤æ˜¯ `è·Ÿéš/Flywithme` æ¨¡å¼ï¼Œå¯¹äºæ±½è½¦æ¥è¯´ï¼Œé»˜è®¤æ˜¯ `SpringArmChase` æ¨¡å¼ã€‚ä¸‹é¢åˆ—å‡ºè¿™äº›æ¨¡å¼ï¼š
>
> - `è·Ÿéš/FlyWithMe`ï¼šä»¥ 6 è‡ªç”±åº¦è·Ÿéšå››æ—‹ç¿¼
> - `FPV`ï¼šæœºè½½æ‘„åƒå¤´è§†è§’
> - `åœ°é¢è§‚å¯Ÿè€…/GroundObserver`ï¼šåœ¨åœ°é¢ä¸Šä»¥ XY å¹³é¢è‡ªç”±åº¦è·Ÿéšå››æ—‹ç¿¼
> - `æ‰‹åŠ¨/Manual`ï¼šæ‰‹åŠ¨è®¾ç½®æ‘„åƒæœºçš„ä½ç½®
> - `å¼¹æ€§æœºè‡‚è·Ÿéš/SpringArmChase`ï¼šæ‘„åƒæœºå›ºå®šåœ¨ä¸€ä¸ªéšå½¢çš„ä¸æ±½è½¦è¿åœ¨ä¸€èµ·çš„å¼¹æ€§æœºè‡‚ä¸Šï¼Œè·Ÿéšæ±½è½¦ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€äº›æ—¶å»¶ã€‚
> - `NoDisplay`ï¼šä¸æ˜¾ç¤ºç”»é¢ï¼Œè¿™å¯ä»¥æé«˜æ¸²æŸ“æ€§èƒ½ï¼Œè€Œä¸”ä¸å½±å“ APIs
>
> æŠŠé¼ æ ‡ç§»åŠ¨åˆ°ä¸­é—´çš„è§†é‡ä¸­éšä¾¿ä¸€ä¸ªä½ç½®ï¼Œç‚¹ä¸€ä¸‹é¼ æ ‡å·¦é”®ï¼Œè¿™æ—¶é¼ æ ‡å°±æ¶ˆå¤±äº†ã€‚è¿™æ—¶å¯ä»¥è®¾ç½®è§†è§’æ¨¡å¼ï¼š
> - `F` æŒ‰é”®ï¼šFPV
> - `B` æŒ‰é”®ï¼šè·Ÿéš/FlyWithMe
> - `\` æŒ‰é”®ï¼šåœ°é¢è§‚å¯Ÿè€…/GroundObserver
> - `/` æŒ‰é”®ï¼šå¼¹æ€§æœºè‡‚è·Ÿéš/SpringArmChase
> - `M` æŒ‰é”®ï¼šæ‰‹åŠ¨/Manual
>
> æŒ‰ `M` æŒ‰é”®è¿›å…¥æ‰‹åŠ¨è®¾ç½®æ¨¡å¼ï¼Œå¯ä»¥è®¾ç½®æ‘„åƒæœºçš„ä½ç½®ï¼š
>
> - æ–¹å‘é”®ï¼šå‰è¿›ã€åé€€ã€å‘å·¦ã€å‘å³ç§»åŠ¨
> - page up/downï¼šä¸Šä¸‹ç§»åŠ¨
> - Wï¼ŒS æŒ‰é”®ï¼šä¿¯ä»°è½¬åŠ¨
> - Aï¼ŒD æŒ‰é”®ï¼šåèˆªè½¬åŠ¨

### 3.2 ä»£ç è¯¦è§£

```python
client.moveByVelocityZAsync(vx, vy, z, duration).join()
```
é€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œè®©å››æ—‹ç¿¼åœ¨ `z` çš„é«˜åº¦ï¼Œä»¥ `vx`ï¼Œ`vy` çš„é€Ÿåº¦ï¼Œé£è¡Œ `duration` ç§’ã€‚

```python
client.hoverAsync().join()
```

è¿™å¥æŒ‡ä»¤çš„åŠŸèƒ½æ˜¯è®©å››æ—‹ç¿¼åœ¨å½“å‰ä½ç½®æ‚¬åœã€‚

### 3.3 é€Ÿåº¦æ§åˆ¶æ–¹æ³• API
```python
def moveByVelocityZAsync(
    self,
    vx,
    vy,
    z,
    duration,
    drivetrain=DrivetrainType.MaxDegreeOfFreedom,
    yaw_mode=YawMode(),
    vehicle_name="",
)
```

### 3.4 é€Ÿåº¦æ§åˆ¶è¯¯å·®
å››æ—‹ç¿¼æ˜¯ä¸€ä¸ªéçº¿æ€§ç³»ç»Ÿï¼Œç»™ä¸€ä¸ªé€Ÿåº¦æŒ‡ä»¤ï¼Œå®ƒæ˜¯ä¸å¯èƒ½ç¬æ—¶åˆ°è¾¾çš„ï¼Œè€Œä¸”è¿™ä¸ªé€Ÿåº¦æŒ‡ä»¤ä¸å½“å‰çš„é€Ÿåº¦ä¹‹å·®è¶Šå¤§ï¼Œè¾¾åˆ°è¿™ä¸ªé€Ÿåº¦æŒ‡ä»¤çš„è°ƒèŠ‚æ—¶é—´å°±è¶Šé•¿ã€‚æ‰€ä»¥åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œæœ€åçš„å››æ—‹ç¿¼å¹¶æ²¡æœ‰å›åˆ°èµ·ç‚¹ä½ç½®ã€‚

ä¸ºäº†åšå¯¹æ¯”ï¼Œå¯ä»¥æŠŠé€Ÿåº¦å¢å¤§ä¸€äº›ï¼Œä¸‹é¢çš„ä»£ç æ˜¯å››æ—‹ç¿¼ä»¥ 8m/s çš„é€Ÿåº¦é£è¡Œ 2 ç§’é’Ÿï¼Œåˆ†åˆ«å‘å‰å³åå·¦å››ä¸ªæ–¹å‘å„é£è¡Œä¸€æ¬¡ï¼Œæœ€åç¦»èµ·ç‚¹ä½ç½®åå·®æ›´å¤§ï¼š

```python
import airsim
 import time
 â€‹
 client = airsim.MultirotorClient()  # connect to the AirSim simulator
 client.enableApiControl(True)       # è·å–æ§åˆ¶æƒ
 client.armDisarm(True)              # è§£é”
 client.takeoffAsync().join()        # ç¬¬ä¸€é˜¶æ®µï¼šèµ·é£
 â€‹
 client.moveToZAsync(-2, 1).join()   # ç¬¬äºŒé˜¶æ®µï¼šä¸Šå‡åˆ°2ç±³é«˜åº¦
 â€‹
 # é£æ­£æ–¹å½¢
 client.moveByVelocityZAsync(8, 0, -2, 2).join()     # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘å‰é£2ç§’é’Ÿ
 client.moveByVelocityZAsync(0, 8, -2, 2).join()     # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘å³é£2ç§’é’Ÿ
 client.moveByVelocityZAsync(-8, 0, -2, 2).join()    # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘åé£2ç§’é’Ÿ
 client.moveByVelocityZAsync(0, -8, -2, 2).join()    # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘å·¦é£2ç§’é’Ÿ
 â€‹
 # æ‚¬åœ 2 ç§’é’Ÿ
 client.hoverAsync().join()          # ç¬¬å››é˜¶æ®µï¼šæ‚¬åœ6ç§’é’Ÿ
 time.sleep(6)
 â€‹
 client.landAsync().join()           # ç¬¬äº”é˜¶æ®µï¼šé™è½
 client.armDisarm(False)             # ä¸Šé”
 client.enableApiControl(False)      # é‡Šæ”¾æ§åˆ¶æƒ
```