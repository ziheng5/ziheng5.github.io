---
title: Airsim ç¬”è®°ï¼šPython API æ€»ç»“
date: 2025-04-13 18:08:04
tags:
    - å¼ºåŒ–å­¦ä¹ 
    - ä»¿çœŸçŽ¯å¢ƒ
categories:
    - é£Ÿç”¨æŒ‡å—
description: |
    âœˆï¸ æ¯”è¾ƒçƒ­é—¨çš„æ— äººæœºå¼ºåŒ–å­¦ä¹ ä»¿çœŸå¹³å°ä¹‹ä¸€
---

> ðŸ“š å°ç”Ÿçš„ç¬”è®°å‚è€ƒè¥¿æ¹–å¤§å­¦å®å­å®‰å¤§ä½¬çš„æ•™ç¨‹ï¼šhttps://www.zhihu.com/column/multiUAV
>
> å¦ï¼šæœ¬æ–‡å†…å®¹å‡åœ¨ Windows æ“ä½œç³»ç»Ÿä¸‹è¿›è¡Œï¼ˆUbuntu ä¸‹çš„ä»¿çœŸçŽ¯å¢ƒæŠ˜è…¾èµ·æ¥æ¯”è¾ƒéº»çƒ¦ ðŸ’¦ï¼‰

## 0. AirSim APIs ç®€ä»‹
---
AirSim å°è£…äº†ä¸€äº› API æŽ¥å£ï¼Œä½¿ç”¨è¿™äº› API æŽ¥å£ï¼Œå¯ä»¥ç”¨ç¨‹åºè·Ÿä»¿çœŸè¿›è¡Œäº¤äº’ã€‚ä¾‹å¦‚å¯ä»¥ä½¿ç”¨ API æ¥èŽ·å–å›¾ç‰‡ã€æ— äººæœºçŠ¶æ€ã€æŽ§åˆ¶æ— äººæœº/è½¦è¾†çš„è¿åŠ¨ç­‰ã€‚

AirSim çš„ API éžå¸¸ä¸°å¯Œï¼Œæœ‰å¾ˆå¤šå¯ä»¥è°ƒç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥å°†è¿™äº›åŠŸèƒ½åˆ†æˆä»¥ä¸‹å‡ ç±»ï¼š

- **å›¾åƒç±» API**ï¼šèŽ·å–å„ç§ç±»åž‹çš„å›¾åƒã€æŽ§åˆ¶äº‘å°ç­‰ï¼›
- **æŽ§åˆ¶ä»¿çœŸè¿è¡Œ**ï¼šå¯ä»¥æŽ§åˆ¶ä»¿çœŸæš‚åœæˆ–ç»§ç»­ï¼›
- **ç¢°æ’ž API**ï¼šèŽ·å–ç¢°æ’žä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¢°æ’žæ¬¡æ•°ã€ä½ç½®ã€è¡¨é¢ä¿¡æ¯ã€æ¸—é€æ·±åº¦ç­‰ï¼›
- **çŽ¯å¢ƒæ—¶é—´ API**ï¼šä¸»è¦æ˜¯æŽ§åˆ¶å¤ªé˜³åœ¨å¤©ç©ºä¸­çš„ä½ç½®ï¼›
- **çŽ¯å¢ƒå¤©æ°” API**ï¼šæŽ§åˆ¶çŽ¯å¢ƒä¸­çš„å¤©æ°”ï¼šä¸‹é›¨ã€é›ªã€ç°å°˜ã€é›¾æ°”ã€é“è·¯æ¹¿æ»‘ç¨‹åº¦ç­‰ï¼›
- **çŽ¯å¢ƒé£Ž API**ï¼šæŽ§åˆ¶çŽ¯å¢ƒä¸­çš„é£Žé€Ÿå’Œé£Žå‘ç­‰ï¼›
- **é›·è¾¾ API**ï¼šæ·»åŠ å’ŒæŽ§åˆ¶çŽ¯å¢ƒä¸­çš„é›·è¾¾ä¼ æ„Ÿå™¨ï¼›
- **æ— äººæœºæˆ–è½¦è¾†çš„ API**ï¼šæŽ§åˆ¶è¿åŠ¨ã€èŽ·å–çŠ¶æ€ç­‰

AirSim çš„ API æœ‰ python å’Œ C++ ä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„ä¹ æƒ¯ä»»æ„é€‰æ‹©ï¼Œè¿™é‡Œä¸»è¦è®°å½• python çš„ä½¿ç”¨æ–¹å¼ã€‚

åœ¨è™šæ‹ŸçŽ¯å¢ƒä¸­å®‰è£… `msgpack-rpc-python` å’Œ `airsim` ä¸¤ä¸ªåº“å³å¯ä½¿ç”¨

```bash
pip install msgpack-rpc-python
pip install airsim
```

## 1. æŽ§åˆ¶æ— äººæœºçš„èµ·é£žå’Œé™è½
---
å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š

```python
import airsim

# connect to the AirSim simulator
client = airsim.MultirotorClient()
client.confirmConnection()

# get control
client.enableApiControl(True)

# unlock
client.armDisarm(True)

# Async methods returns Future. Call join() to wait for task to complete.
client.takeoffAsync().join()
client.landAsync().join()

# lock
client.armDisarm(False)

# release control
client.enableApiControl(False)
```

> åœ¨è¿è¡Œä¸Šé¢è¿™æ®µä»£ç ä¹‹å‰ï¼Œéœ€è¦å…ˆå°† AirSim è¿è¡Œèµ·æ¥ã€‚
> 
> å…ˆå°† `C:\Users\[ç”¨æˆ·å]\Documents\AirSim` è·¯å¾„ä¸‹çš„ `settings.json` æ–‡ä»¶ä¸­çš„ä»¿çœŸæ¨¡å¼æ”¹ä¸ºå¤šæ—‹ç¿¼ï¼Œå¦‚ä¸‹æ‰€ç¤º
>
> ```json
> {
>     "SettingsVersion": 1.2,
>     "SimMode": "Multirotor"
> }
> ```
> 
> ä¿®æ”¹å®ŒæˆåŽï¼Œæ‰“å¼€ä¹‹å‰å®‰è£…å¥½çš„ `LandscapeMountains` çŽ¯å¢ƒç›®å½•ä¸‹çš„ `LandscapeMountains.sln` æ–‡ä»¶ï¼›Visual Studio ä¸­ï¼Œé€‰æ‹©ç¼–è¾‘æ¨¡å¼ä¸º `Debug Game Editor` å’Œ `win64`ï¼Œç¡®ä¿ `LandscapeMountains` ä¸ºå¯åŠ¨é¡¹ç›®ã€‚
>
> ç„¶åŽç‚¹å‡» `æœ¬åœ°Windowsè°ƒè¯•å™¨`ï¼Œè¿™æ—¶å°±ä¼šæ‰“å¼€ Unreal Editorï¼›åœ¨ Unreal Editor ä¸­ç‚¹å‡» `æ’­æ”¾(Play)` æŒ‰é’®ï¼Œä»¿çœŸå¼€å§‹è¿è¡Œã€‚
>
> æ— äººæœºåˆå§‹ä½ç½®è®¾ç½®çš„æ˜¯åœ¨ç©ºä¸­ï¼Œæ‰€ä»¥åˆšä¸€ç‚¹å‡»`æ’­æ”¾`æŒ‰é’®æ—¶ï¼Œæ— äººæœºä¼šå‘ä¸‹è½ï¼Œæœ€åŽè§¦åœ°ï¼ŒåŒæ—¶æœºç¿¼ä¹Ÿä¸€ç›´æ—‹è½¬ã€‚å› ä¸ºæœ‰ä¸¤ä¸ªç‰©ä½“çš„ç¢°æ’žï¼Œæ‰€ä»¥ç”»é¢ä¸­ç»™å‡ºäº†ä¸€ä¸ªç¢°æ’žè­¦å‘Šã€‚ï¼ˆåˆå§‹ä½ç½®æ˜¯å¯ä»¥è‡ªå·±è°ƒçš„ï¼‰
>
> æ³¨æ„ï¼Œåœ¨ `LandscapeMountain` è¿™ä¸ªçŽ¯å¢ƒä¸­ï¼Œæ°´é¢å°±æ˜¯ä¸€ä¸ªç‰©ä½“ï¼Œå®ƒè·ŸçŸ³å¤´ã€æ ‘æœ¨ç­‰æœ‰ç›¸åŒçš„ç‰©ç†ç‰¹æ€§ï¼Œæ‰€ä»¥æ— äººæœºä¸ä¼šè½åˆ°æ°´ä¸­ï¼Œè€Œæ˜¯åœ¨ç¡çœ ï¼Œå°±åƒåœ¨å¹³åœ°ä¸Šç€é™†ä¸€æ ·ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªçŽ¯å¢ƒä¸­çš„ä»¿çœŸï¼Œå°±å¯ä»¥æŠŠæ°´é¢å½“åšå¹³åœ°æ¥çœ‹å¾…ã€‚

ä»£ç è¯¦è§£ï¼š

```python
client = airsim.MultirotorClient()
```

ä¸Ž AirSim å»ºç«‹è¿žæŽ¥ï¼Œå¹¶ä¸”è¿”å›žå¥æŸ„ï¼ˆclientï¼‰ï¼ŒåŽé¢çš„æ¯æ¬¡æ“ä½œéœ€è¦ä½¿ç”¨è¿™ä¸ªå¥æŸ„ã€‚

å¦‚æžœæ˜¯æ±½è½¦ä»¿çœŸï¼Œä»£ç æ˜¯ï¼š`client = airsim.CarClient()`ï¼›

```python
client.confirmConnection()
```

æ£€æŸ¥é€šä¿¡æ˜¯å¦å»ºç«‹æˆåŠŸï¼Œå¹¶ä¸”ä¼šåœ¨å‘½ä»¤è¡Œä¸­æ‰“å°è¿žæŽ¥æƒ…å†µï¼Œè¿™æ ·å°±å¯ä»¥åˆ¤æ–­ç¨‹åºæ˜¯å¦å’Œ AirSim è¿žæŽ¥æ­£å¸¸ï¼Œå¦‚æžœè¿žæŽ¥æ­£å¸¸ä¼šåœ¨å‘½ä»¤è¡Œä¸­æ‰“å°å¦‚ä¸‹ï¼š

```Terminal
Connected!
Client Ver:1 (Min Req: 1), Server Ver:1 (Min Req: 1)
```

```python
client.enableApiControl(True)   # get control
client.enableApiControl(False)  # release control
```

å› ä¸ºå®‰å…¨é—®é¢˜ï¼Œ API æŽ§åˆ¶é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œé¥æŽ§å™¨æœ‰å…¨éƒ¨çš„æŽ§åˆ¶æƒé™ã€‚æ‰€ä»¥å¿…é¡»è¦åœ¨ç¨‹åºä¸­ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥èŽ·å–æŽ§åˆ¶æƒã€‚é¥æŽ§å™¨çš„æ“ä½œä¼šæŠ¢å¤º API çš„æŽ§åˆ¶æƒï¼ŒåŒæ—¶è®© API èŽ·å–çš„æŽ§åˆ¶æƒå¤±æ•ˆã€‚ä½¿ç”¨ `isApiControlEnabled` å¯æ£€æŸ¥ API æ˜¯å¦å…·æœ‰æŽ§åˆ¶æƒã€‚

å¯èƒ½ä¼šæœ‰äººé—®ä¸ºä»€ä¹ˆæœ€åŽç»“æŸçš„æ—¶å€™è¦é‡Šæ”¾æŽ§åˆ¶æƒï¼Œåæ­£éƒ½æ˜¯ä»¿çœŸï¼Œç»“æŸä»¿çœŸå°±å¥½äº†ã€‚ä½†æ˜¯å®žé™…ä¸Š AirSim çš„å¼€å‘äººå‘˜å¸Œæœ›åœ¨ä»¿çœŸä¸­çš„ä»£ç å¯ä»¥ç›´æŽ¥ç§»åˆ°çŽ°å®žä¸­ä½¿ç”¨ï¼Œæ‰€ä»¥å¯¹äºŽçŽ°å®žä¸­çš„å®‰å…¨é—®é¢˜ï¼Œè¿˜æ˜¯å¼€å‘äº†èŽ·å–æŽ§åˆ¶æƒå’Œé‡Šæ”¾æŽ§åˆ¶æƒã€è§£é”å’Œä¸Šé”ç­‰ä¸€ç³»åˆ—å®‰å…¨æ“ä½œã€‚

```python
client.takeoffAsync().join()    # èµ·é£ž
client.landAsync().join()   # é™è½
```

è¿™ä¸¤ä¸ªå‡½æ•°å¯ä»¥è®©æ— äººæœºèµ·é£žå’Œé™è½ã€‚

å¾ˆå¤šæ— äººæœºæˆ–è€…æ±½è½¦æŽ§åˆ¶çš„å‡½æ•°éƒ½æœ‰ `Async` ä½œä¸ºåŽç¼€ï¼Œè¿™äº›å‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šç«‹å³è¿”å›žï¼Œè¿™æ ·çš„è¯ï¼Œè™½ç„¶ä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä½†æ˜¯ç¨‹åºå¯ä»¥ç»§ç»­æ‰§è¡Œä¸‹åŽ»ï¼Œè€Œä¸ç”¨ç­‰å¾…è¿™ä¸ªå‡½æ•°çš„ä»»åŠ¡åœ¨ä»¿çœŸä¸­æœ‰æ²¡æœ‰æ‰§è¡Œå®Œã€‚

å¦‚æžœä½ æƒ³è®©ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œï¼Œåˆ™åªéœ€è¦åœ¨åŽé¢åŠ ä¸Š `.join()`ã€‚æœ¬ä¾‹å­å°±æ˜¯è®©ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…æ— äººæœºèµ·é£žä»»åŠ¡å®Œæˆï¼Œç„¶åŽå†æ‰§è¡Œé™è½ä»»åŠ¡ã€‚

æ–°çš„ä»»åŠ¡ä¼šæ‰“æ–­ä¸Šä¸€ä¸ªæ²¡æœ‰æ‰§è¡Œå®Œçš„ä»»åŠ¡ï¼Œæ‰€ä»¥å¦‚æžœ `takeoff` å‡½æ•°æ²¡æœ‰åŠ  `.join()`ï¼Œåˆ™æœ€åŽçš„è¡¨çŽ°æ˜¯æ— äººæœºè¿˜æ²¡æœ‰èµ·é£žå°±é™è½äº†ï¼Œæ— äººæœºæ˜¯ä¸ä¼šèµ·é£žçš„ã€‚

> **Python ä¸Ž AirSim çš„é€šä¿¡æœºåˆ¶**
>
> AirSim API ä½¿ç”¨çš„æ˜¯ `TCP/IP` ä¸­çš„ `msgpack-rpc` åè®®ï¼Œè¿™æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œæ‰€ä»¥å¦‚æžœè®¾ç½®æ­£ç¡®ï¼Œå…¶å®žå¯ä»¥ç”¨ä¸¤å°ä¸åŒçš„ç”µè„‘æ¥åšä»¿çœŸï¼Œä¸€å°è·‘ AirSim å’Œ Unrealï¼Œå¦ä¸€å°è·‘ python ç¨‹åºã€‚
>
>å½“ AirSim å¼€å§‹ä»¿çœŸçš„æ—¶å€™ï¼Œä¼šæ‰“å¼€ 41451 ç«¯å£ï¼Œå¹¶ç›‘å¬è¿™ä¸ªç«¯å£çš„éœ€æ±‚ã€‚python ç¨‹åºä½¿ç”¨ `msgpack serialization` æ ¼å¼å‘è¿™ä¸ªç«¯å£å‘é€ RPC åŒ…ï¼Œå°±å¯ä»¥ä¸Ž AirSim è¿›è¡Œé€šä¿¡äº†ã€‚

## 2. æŽ§åˆ¶å››æ—‹ç¿¼çš„é£žè¡Œï¼ˆcore APIï¼‰
---
### 2.1 æŽ§åˆ¶æ ·ä¾‹
ç¤ºä¾‹ä»£ç ï¼š

```python
import airsim
import time

# connect to the Airsim simulator
client = airsim.MultirotorClient()

client.enableApiControl(True)   # get control
client.armDisarm(True)          # unlock
client.takeoffAsync().join()    # takeoff

# square flight
client.moveToZAsync(-3, 1).join()               # ä¸Šå‡åˆ° 3m é«˜åº¦
client.moveToPositionAsync(5, 0, -3, 1).join()  # é£žåˆ°ï¼ˆ5, 0ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(5, 5, -3, 1).join()  # é£žåˆ°ï¼ˆ5, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 5, -3, 1).join()  # é£žåˆ°ï¼ˆ0, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 0, -3, 1).join()  # é£žåˆ°ï¼ˆ0, 0ï¼‰ç‚¹åæ ‡

client.landAsync().join()       # land
client.armDisarm(False)         # lock
client.enableApiControl(False)  # release control
```

ä¸Šé¢è¿™æ®µä»£ç å®žçŽ°çš„æ•ˆæžœæ˜¯ï¼š

- ç¬¬ä¸€é˜¶æ®µï¼šèµ·é£ž
- ç¬¬äºŒé˜¶æ®µï¼šä¸Šå‡åˆ° 3m é«˜åº¦
- ç¬¬ä¸‰é˜¶æ®µï¼šé£žæ­£æ–¹å½¢
  - å‘å‰é£ž 5mï¼ˆæ²¿ x è½´æ­£æ–¹å‘ï¼‰
  - å‘å³é£ž 5m
  - å‘åŽé£ž 5m
  - å‘å·¦é£ž 5mï¼Œå›žåˆ°èµ·é£žç‚¹
- ç¬¬å››é˜¶æ®µï¼šé™è½

> âš ï¸ æ³¨æ„ï¼Œå¦‚æžœä½ çš„ä»¿çœŸåœ¨åˆšå¼€å§‹çš„æ—¶å€™ï¼Œå››æ—‹ç¿¼å¹¶ä¸æ˜¯æ­£å‰æ–¹ï¼Œè¯´æ˜Ž player start çš„ä½ç½®æ˜¯æœ‰è§’åº¦çš„ï¼Œå°†å…¶æ”¹æˆ 0 å³å¯ã€‚

ä»£ç è¯¦è§£ï¼š

```python
client.moveToZAsync(-3, 1).join()   # é«˜åº¦æŽ§åˆ¶
```

`moveToAsync(z, velocity)` æ˜¯é«˜åº¦æŽ§åˆ¶ APIï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯**é«˜åº¦**ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯**é€Ÿåº¦**ã€‚å®žçŽ°çš„æ•ˆæžœæ˜¯æ— äººæœºä»¥ 1m/s çš„é€Ÿåº¦é£žåˆ° 3m é«˜ã€‚`.join()` åŽç¼€çš„æ„æ€æ˜¯ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…ç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼è¾¾åˆ° 3m çš„é«˜åº¦ã€‚å¦‚æžœä¸åŠ  `.join()` åŽç¼€ï¼Œåˆ™ä¸ç”¨ç­‰å¾…ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œå‡½æ•°ç›´æŽ¥è¿”å›žï¼Œç¨‹åºç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚

```python
client.moveToPositionAsync(5, 0, -3, 1).join()  # é£žåˆ°ï¼ˆ5, 0ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(5, 5, -3, 1).join()  # é£žåˆ°ï¼ˆ5, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 5, -3, 1).join()  # é£žåˆ°ï¼ˆ0, 5ï¼‰ç‚¹åæ ‡
client.moveToPositionAsync(0, 0, -3, 1).join()  # é£žåˆ°ï¼ˆ0, 0ï¼‰ç‚¹åæ ‡
```

`moveToPositionAsync(x, y, z, velocity)` æ˜¯æ°´å¹³ä½ç½®æŽ§åˆ¶ APIï¼Œ`x, y, z` æ˜¯å…¨å±€åæ ‡ä½ç½®ï¼Œ`velocity` æ˜¯é€Ÿåº¦ã€‚å®žçŽ°çš„æ•ˆæžœæ˜¯ä»¥ 1m/s çš„é€Ÿåº¦é£žåˆ° (5, 0) ç‚¹ï¼Œ3m é«˜çš„ä½ç½®ã€‚`.join()` åŽç¼€çš„æ„æ€æ˜¯ç¨‹åºåœ¨è¿™é‡Œç­‰å¾…ç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼åˆ°è¾¾ç›®æ ‡ä½ç½®ç‚¹ï¼ŒåŒæ—¶åˆ°è¾¾è®¾ç½®çš„é«˜åº¦ã€‚å¦‚æžœä¸åŠ  `.join()` åŽç¼€ï¼Œåˆ™ä¸ç”¨ç­‰å¾…ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œå‡½æ•°ç›´æŽ¥è¿”å›žï¼Œç¨‹åºç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚

### 2.2 å››æ—‹ç¿¼åº•å±‚é£žæŽ§é€šé“ç®€ä»‹
å…³äºŽå››æ—‹ç¿¼çš„éžçº¿æ€§å»ºæ¨¡å’Œåº•å±‚æŽ§åˆ¶å™¨è®¾è®¡ï¼Œåœ¨åŽé¢è¯¦ç»†è®²è§£ï¼Œç›®å‰å…ˆç®€å•ä»‹ç»ä¸€ä¸‹å››æ—‹ç¿¼çš„åº•å±‚é£žæŽ§å¯ä»¥æŽ§åˆ¶ä»€ä¹ˆé‡ã€‚å½“å››æ—‹ç¿¼ä½Žé€Ÿé£žè¡Œæ—¶ï¼Œå…¶åº•å±‚é£žæŽ§å¯ä»¥è§£è€¦ä¸º 3 ä¸ªé€šé“ï¼š
- æ°´å¹³é€šé“
- é«˜åº¦é€šé“
- åèˆªé€šé“

è¿™ 3 ä¸ªé€šé“å¯ä»¥åˆ†åˆ«æŽ§åˆ¶ï¼Œå¯ä»¥ç†è§£ä¸ºé€šé“ä¹‹é—´ç›¸äº’ä¸ä¼šå½±å“ã€‚æ°´å¹³é€šé“å¯ä»¥æŽ§åˆ¶å››æ—‹ç¿¼çš„æ°´å¹³ä½ç½®ã€æ°´å¹³é€Ÿåº¦ã€æ°´å¹³å§¿æ€è§’ï¼›é«˜åº¦é€šé“å¯ä»¥æŽ§åˆ¶åž‚ç›´é«˜åº¦ã€åž‚ç›´é€Ÿåº¦ã€åž‚ç›´åŠ é€Ÿåº¦ï¼›åèˆªé€šé“å¯ä»¥æŽ§åˆ¶åèˆªè§’åº¦ã€åèˆªè§’é€Ÿåº¦ã€åèˆªè§’åŠ é€Ÿåº¦ã€‚

æœ¬æ–‡ä¾‹å­ç¨‹åºä¸­ `x, y` æ˜¯æ°´å¹³é€šé“çš„æŒ‡ä»¤ï¼ŒæŽ§åˆ¶å››æ—‹ç¿¼æ°´å¹³æ–¹å‘çš„é£žè¡Œï¼›`z` æ˜¯é«˜åº¦é€šé“æŒ‡ä»¤ï¼ŒæŽ§åˆ¶å››æ—‹ç¿¼çš„é«˜åº¦ã€‚æœ¬æ–‡ä¾‹å­ç¨‹åºä¸­æ²¡æœ‰åèˆªé€šé“æŒ‡ä»¤ï¼Œé»˜è®¤çš„åèˆªæ˜¯ 0ï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼è‡ªèº«ä¸ä¼šæ°´å¹³æ—‹è½¬ï¼Œå…¶æœå‘å§‹ç»ˆæœå‘å‰æ–¹ã€‚

### 2.3 æ°´å¹³ä½ç½®æŽ§åˆ¶å‡½æ•°
å‡½æ•°å®šä¹‰

```python
def moveToPositionAsync(
    self,
    x, 
    y,
    z,
    velocity,
    timeout_sec=3e38,
    drivetrain=DrivetrainType.MaxDegreeOfFreedom,
    yaw_mode=YawMode(),
    lookahead=-1,
    adaptive_lookahead=1,
    vehicle_name="",
)
```

è¾“å…¥å‚æ•°åŒ…æ‹¬ï¼š

- x, y, zï¼šä½ç½®åæ ‡ï¼ˆå…¨å±€åæ ‡ç³»-åŒ—ä¸œåœ°ï¼‰
- velocityï¼šé£žè¡Œé€Ÿåº¦ï¼ˆm/sï¼‰
- timeout_secï¼šå¦‚æžœæ²¡æœ‰ç›¸åº”ï¼Œè¶…æ—¶æ—¶é—´
- drivetrain, yaw_modeï¼šè®¾ç½®é£žè¡Œæœå‘æ¨¡å¼å’Œ yaw è§’æŽ§åˆ¶æ¨¡å¼
- lookahead, adaptive_lookaheadï¼šè®¾ç½®è·¯å¾„é£žè¡Œçš„æ—¶å€™çš„ yaw è§’æŽ§åˆ¶æ¨¡å¼
- vehicle_nameï¼šæŽ§åˆ¶çš„å››æ—‹ç¿¼çš„åå­—

`x, y, z, velocity` è¿™å››ä¸ªå‚æ•°æ˜¯å¿…é¡»è¦è®¾ç½®çš„é‡ï¼ŒæŒ‡ç¤ºå››æ—‹ç¿¼ä»¥å¤šå¤§çš„é€Ÿåº¦é£žå¾€å“ªä¸ªåæ ‡ç‚¹ã€‚åŽé¢çš„å‡ ä¸ªå‚æ•°éƒ½æœ‰å…¶é»˜è®¤å€¼ï¼Œä¸ç”¨è®¾ç½®ä¹Ÿå¯ä»¥ã€‚

`lookahead` å’Œ `adaptive_lookahead` è¿™ä¸¤ä¸ªå‚æ•°æ˜¯è®¾ç½®å½“å››æ—‹ç¿¼é£žè½¨è¿¹çš„æ—¶å€™çš„æœå‘ï¼Œç›®å‰è¿˜ç”¨ä¸åˆ°ã€‚

`vehicle_name` æ˜¯æŒ‡å°†æŒ‡ä»¤å‘é€ç»™å“ªä¸ªå››æ—‹ç¿¼ï¼Œå½“åšå¤šä¸ªå››æ—‹ç¿¼ååŒé£žè¡ŒæŽ§åˆ¶çš„æ—¶å€™ï¼Œè¿™ä¸ªå‚æ•°å°±æ´¾ä¸Šç”¨åœºäº†ï¼ŒåŽé¢ä¼šæœ‰å¤šæœºååŒç¼–é˜Ÿçš„å†…å®¹ã€‚

`drivetrain` å’Œ `yaw_mode` è¿™ä¸¤ä¸ªå‚æ•°çš„ç»„åˆå¯ä»¥è®¾ç½®å››æ—‹ç¿¼çš„åèˆªè§’æŽ§åˆ¶æ¨¡å¼ï¼Œä¸‹é¢è¯¦ç»†ä»‹ç»ã€‚

### 2.4 åèˆªè§’æŽ§åˆ¶æ¨¡å¼è¯¦è§£

drivetrain å‚æ•°å¯ä»¥è®¾ç½®ä¸ºä¸¤ä¸ªé‡ï¼š
- `airsim.DrivetrainType.ForwardOnly`ï¼šå§‹ç»ˆæœå‘é€Ÿåº¦æ–¹å‘
- `airsim.DrivetrainType.MaxDegreeOfFreedom`ï¼šæ‰‹åŠ¨è®¾ç½® yaw è§’åº¦

`yaw_mode` å¿…é¡»è®¾ç½®ä¸º `YawMode()` ç±»åž‹çš„å˜é‡ï¼Œè¿™ä¸ªç»“æž„ä½“ç±»åž‹åŒ…å«ä¸¤ä¸ªå±žæ€§ï¼š

- `YawMode().is_rate`ï¼šTrue - è®¾ç½®è§’é€Ÿåº¦ï¼›False - è®¾ç½®è§’åº¦ã€‚
- `YawMode().yaw_or_rate`ï¼šå¯ä»¥æ˜¯ä»»æ„æµ®ç‚¹æ•°

ä¸‹é¢åˆ†å‡ ç§æƒ…å†µè®¨è®ºï¼š

#### æƒ…å†µ1ï¼ˆä¸å…è®¸ï¼‰
```python
drivetrain = airsim.DrivetrainType.ForwardOnly
yaw_mode = airsim.YawMode(True, 0)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```
å½“ `drivetrain = airsim.DrivetrainType.ForwardOnly` æ—¶ï¼Œå››æ—‹ç¿¼å§‹ç»ˆæœå‘å…¶é£žè¡Œçš„æ–¹å‘ï¼Œè¿™æ—¶ `yaw_mode` ä¸å…è®¸è®¾ç½®ä¸º `YawMode().is_rate = True`ã€‚å› ä¸ºå‰é¢çš„å‚æ•°è¦æ±‚å››æ—‹ç¿¼æœå‘è¿åŠ¨æ–¹å‘ï¼Œè€Œ `yaw_mode` è¦æ±‚å››æ—‹ç¿¼ä»¥ä¸€å®šçš„è§’é€Ÿåº¦æ—‹è½¬ï¼Œè¿™æ˜¯çŸ›ç›¾çš„ã€‚

#### æƒ…å†µ2
```python
drivetrain = airsim.DrivetrainType.ForwardOnly
yaw_mode = airsim.YawMode(False, 90)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```
è¿™ç§æƒ…å†µä¸‹ï¼Œå››æ—‹ç¿¼çš„æœå‘å§‹ç»ˆä¸Žå‰è¿›æ–¹å‘ç›¸å·® 90 åº¦ï¼Œä¹Ÿå°±æ˜¯å››æ—‹ç¿¼å§‹ç»ˆå‘å·¦ä¾§æ–¹å‘è¿åŠ¨ã€‚ä¾‹å¦‚ï¼šå½“å››æ—‹ç¿¼åœ¨ç»•ç€ä¸€ä¸ªåœ†å¿ƒè½¬åœˆæ—¶ï¼Œå…¶æœå‘å§‹ç»ˆæŒ‡å‘åœ†å¿ƒï¼ˆè¿™ç§é£žè¡ŒçŠ¶æ€çš„ä»£ç åœ¨åŽé¢ç»™å‡ºï¼‰ã€‚è¿™é‡Œçš„ 90 åº¦å¯ä»¥ä»»æ„è®¾ç½®ã€‚

#### æƒ…å†µ3
```python
drivetrain = airsim.DrivetrainType.MaxDegreeOfFreedom
yaw_mode = airsim.YawMode(False, 0)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```
è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ç®¡é€Ÿåº¦æ–¹å‘æ˜¯ä»€ä¹ˆï¼Œå››æ—‹ç¿¼çš„ yaw è§’å§‹ç»ˆç­‰äºŽ 0ï¼Œä¹Ÿå°±æ˜¯å…¶æœå‘å§‹ç»ˆæŒ‡å‘æ­£åŒ—æ–¹å‘ã€‚å¦‚æžœæ˜¯ 90 åº¦ï¼Œåˆ™å§‹ç»ˆæŒ‡å‘æ­£ä¸œæ–¹å‘ï¼Œè€Œ -90 åº¦ï¼Œåˆ™å§‹ç»ˆæŒ‡å‘æ­£è¥¿æ–¹å‘ã€‚

#### æƒ…å†µ4
```python
drivetrain = airsim.DrivetrainType.MaxDegreeOfFreedom
yaw_mode = airsim.YawMode(True, 10)
client.moveToPositionAsync(x, y, z, velocity, drivetrain=drivetrain, yaw_mode=yaw_mode).join()
```

è¿™ç§æƒ…å†µä¸‹ï¼Œå››æ—‹ç¿¼ä¸ç®¡é€Ÿåº¦æ–¹å‘æ˜¯ä»€ä¹ˆï¼Œyaw è§’ä»¥ 10 åº¦/ç§’çš„é€Ÿåº¦æ—‹è½¬ã€‚

ä¸‹é¢æ€»ç»“ä¸€ä¸‹è¿™ä¸¤ä¸ªå‚æ•°çš„è®¾ç½®å¯¹æ•ˆæžœçš„å½±å“ï¼š

||ForwardOnly|MaxDegreeOfFreedom|
|---|---|---|
|is_rate=True|ä¸å…è®¸|yaw è§’ä»¥ yaw_or_rate åº¦/ç§’æ—‹è½¬|
|is_rate=False|yaw è§’ç›¸å¯¹äºŽé€Ÿåº¦æ–¹å‘åå·® yaw_or_rate åº¦|yaw è§’ç›¸å¯¹æ­£åŒ—æ–¹å‘åå·® yaw_or_rate åº¦|

> **AirSim åæ ‡ç³»å®šä¹‰**
>
> ä¸ºä»€ä¹ˆ 0 åº¦æ˜¯æ­£åŒ—æ–¹å‘å‘¢ï¼Œè¿™å°±æ¶‰åŠåˆ°åæ ‡ç³»çš„å®šä¹‰äº†ï¼Œä¸‹é¢å…ˆç®€å•ä»‹ç»ä¸€ä¸‹åæ ‡ç³»çš„å®šä¹‰
>
> Unreal å¼•æ“Žä¸­çš„åæ ‡ç³»ä¸Ž AirSim å®šä¹‰çš„åæ ‡ç³»æ˜¯ä¸åŒçš„ï¼Œç”šè‡³é•¿åº¦å•ä½éƒ½ä¸åŒã€‚Unreal çš„é•¿åº¦å•ä½æ˜¯åŽ˜ç±³ï¼Œè€Œ AirSim çš„é•¿åº¦å•ä½æ˜¯ç±³ã€‚ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼ŒAirSim å·²ç»éžå¸¸å¥½åœ°å¤„ç†äº†è¿™ä¸ªé—®é¢˜ï¼Œä½ ä¸ç”¨åœ¨æ„ Unreal çš„åæ ‡ç³»æ˜¯ä»€ä¹ˆï¼Œåªéœ€è¦æŒ‰ç…§ AirSim çš„åæ ‡ç³»è®¾ç½®å³å¯ï¼ŒAirSim ä¼šå¸®ä½ è‡ªåŠ¨è½¬æ¢çš„ã€‚
>
> æœ¬æ–‡å…ˆè¯´æ˜Žä¸¤ä¸ªåæ ‡ç³»çš„å®šä¹‰ï¼š**å…¨å±€åæ ‡ç³»ã€æœºä½“åæ ‡ç³»**ã€‚
>
> **å…¨å±€åæ ‡ç³»**æ˜¯å›ºè¿žåˆ°å¤§åœ°çš„ï¼Œx, y, z ä¸‰ä¸ªåæ ‡è½´çš„æŒ‡å‘åˆ†åˆ«æ˜¯åŒ—ã€ä¸œã€åœ°ï¼Œä¹Ÿå°±æ˜¯æœåŒ—æ˜¯ x è½´çš„æ­£æ–¹å‘ï¼Œæœå—æ˜¯ x è½´çš„è´Ÿæ–¹å‘ã€‚å…¨å±€åæ ‡ç³»çš„åŽŸç‚¹ä½ç½®æ˜¯å¤§åœ°çš„æŸä¸€ç‚¹ï¼ˆå¯ä»¥åœ¨ settings æ–‡ä»¶ä¸­è®¾ç½®ï¼‰ã€‚
>
> **æœºä½“åæ ‡ç³»**æ˜¯å›ºè¿žåˆ°å››æ—‹ç¿¼æœºèº«çš„ï¼Œx, y, z ä¸‰ä¸ªåæ ‡è½´çš„æŒ‡å‘åˆ†åˆ«æ˜¯å‰ã€å³ã€ä¸‹ï¼Œä¹Ÿå°±æ˜¯é£žæœºçš„å‰æ–¹æ˜¯ x è½´çš„æ­£æ–¹å‘ï¼Œé£žæœºåŽæ–¹æ˜¯ x è½´çš„è´Ÿæ–¹å‘ã€‚æœºä½“åæ ‡ç³»çš„åŽŸç‚¹ä½ç½®æ˜¯æœºä½“çš„é‡å¿ƒä½ç½®ã€‚

## 3. é€Ÿåº¦æŽ§åˆ¶
---

### 3.1 æŽ§åˆ¶æ ·ä¾‹
è€æ ·å­ï¼Œå…ˆä¸Šç¤ºä¾‹ï¼š

```python
import airsim
import time

client = airsim.MultirotorClient()  # connect to the AirSim simulator
client.enableApiControl(True)       # èŽ·å¾—æŽ§åˆ¶æƒ
client.armDisarm(True)              # è§£é”
client.takeoffAsync().join()        # ç¬¬ä¸€é˜¶æ®µï¼šèµ·é£ž

client.moveToZAsync(-2, 1).join()   # ç¬¬äºŒé˜¶æ®µï¼šä¸Šå‡åˆ° 2m é«˜åº¦

# é£žæ­£æ–¹å½¢
client.moveByVelocityZAsync(1, 0, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘å‰é£ž 8 ç§’é’Ÿ
client.moveByVelocityZAsync(0, 1, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘å³é£ž 8 ç§’é’Ÿ
client.moveByVelocityZAsync(-1, 0, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘åŽé£ž 8 ç§’é’Ÿ
client.moveByVelocityZAsync(0, -1, -2, 8).join() # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥ 1m/s é€Ÿåº¦å‘å·¦é£ž 8 ç§’é’Ÿ

# æ‚¬åœ 2 ç§’é’Ÿ
client.hoverAsync().join()      # ç¬¬å››é˜¶æ®µï¼šæ‚¬åœ 6 ç§’
time.sleep(6)

client.landAsync().join()       # ç¬¬äº”é˜¶æ®µï¼šé™è½
client.armDisarm(False)         # ä¸Šé”
client.enableApiControl(False)  # é‡Šæ”¾æŽ§åˆ¶æƒ
```

> åœ¨è§†é¢‘æ¼”ç¤ºçš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®å›ºå®šè§†è§’æ¥è§‚å¯Ÿå››æ—‹ç¿¼è¿åŠ¨çš„è½¨è¿¹ï¼Œæ–¹æ³•å¦‚ä¸‹ã€‚
>
> ç‚¹å‡» `è¿è¡Œ/Play` æŒ‰é’®åŽï¼Œä¸­é—´çš„è§†è§’é»˜è®¤æ˜¯è·Ÿéšè§†è§’ï¼Œè§†è§’çš„è®¾ç½®å†³å®šäº†æ‘„åƒæœºå¦‚ä½•è·Ÿéšå››æ—‹ç¿¼ï¼Œå¯¹äºŽå››æ—‹ç¿¼æ¥è¯´ï¼Œé»˜è®¤æ˜¯ `è·Ÿéš/Flywithme` æ¨¡å¼ï¼Œå¯¹äºŽæ±½è½¦æ¥è¯´ï¼Œé»˜è®¤æ˜¯ `SpringArmChase` æ¨¡å¼ã€‚ä¸‹é¢åˆ—å‡ºè¿™äº›æ¨¡å¼ï¼š
>
> - `è·Ÿéš/FlyWithMe`ï¼šä»¥ 6 è‡ªç”±åº¦è·Ÿéšå››æ—‹ç¿¼
> - `FPV`ï¼šæœºè½½æ‘„åƒå¤´è§†è§’
> - `åœ°é¢è§‚å¯Ÿè€…/GroundObserver`ï¼šåœ¨åœ°é¢ä¸Šä»¥ XY å¹³é¢è‡ªç”±åº¦è·Ÿéšå››æ—‹ç¿¼
> - `æ‰‹åŠ¨/Manual`ï¼šæ‰‹åŠ¨è®¾ç½®æ‘„åƒæœºçš„ä½ç½®
> - `å¼¹æ€§æœºè‡‚è·Ÿéš/SpringArmChase`ï¼šæ‘„åƒæœºå›ºå®šåœ¨ä¸€ä¸ªéšå½¢çš„ä¸Žæ±½è½¦è¿žåœ¨ä¸€èµ·çš„å¼¹æ€§æœºè‡‚ä¸Šï¼Œè·Ÿéšæ±½è½¦ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€äº›æ—¶å»¶ã€‚
> - `NoDisplay`ï¼šä¸æ˜¾ç¤ºç”»é¢ï¼Œè¿™å¯ä»¥æé«˜æ¸²æŸ“æ€§èƒ½ï¼Œè€Œä¸”ä¸å½±å“ APIs
>
> æŠŠé¼ æ ‡ç§»åŠ¨åˆ°ä¸­é—´çš„è§†é‡Žä¸­éšä¾¿ä¸€ä¸ªä½ç½®ï¼Œç‚¹ä¸€ä¸‹é¼ æ ‡å·¦é”®ï¼Œè¿™æ—¶é¼ æ ‡å°±æ¶ˆå¤±äº†ã€‚è¿™æ—¶å¯ä»¥è®¾ç½®è§†è§’æ¨¡å¼ï¼š
> - `F` æŒ‰é”®ï¼šFPV
> - `B` æŒ‰é”®ï¼šè·Ÿéš/FlyWithMe
> - `\` æŒ‰é”®ï¼šåœ°é¢è§‚å¯Ÿè€…/GroundObserver
> - `/` æŒ‰é”®ï¼šå¼¹æ€§æœºè‡‚è·Ÿéš/SpringArmChase
> - `M` æŒ‰é”®ï¼šæ‰‹åŠ¨/Manual
>
> æŒ‰ `M` æŒ‰é”®è¿›å…¥æ‰‹åŠ¨è®¾ç½®æ¨¡å¼ï¼Œå¯ä»¥è®¾ç½®æ‘„åƒæœºçš„ä½ç½®ï¼š
>
> - æ–¹å‘é”®ï¼šå‰è¿›ã€åŽé€€ã€å‘å·¦ã€å‘å³ç§»åŠ¨
> - page up/downï¼šä¸Šä¸‹ç§»åŠ¨
> - Wï¼ŒS æŒ‰é”®ï¼šä¿¯ä»°è½¬åŠ¨
> - Aï¼ŒD æŒ‰é”®ï¼šåèˆªè½¬åŠ¨

### 3.2 ä»£ç è¯¦è§£

```python
client.moveByVelocityZAsync(vx, vy, z, duration).join()
```
é€Ÿåº¦æŽ§åˆ¶å‡½æ•°ï¼Œè®©å››æ—‹ç¿¼åœ¨ `z` çš„é«˜åº¦ï¼Œä»¥ `vx`ï¼Œ`vy` çš„é€Ÿåº¦ï¼Œé£žè¡Œ `duration` ç§’ã€‚

```python
client.hoverAsync().join()
```

è¿™å¥æŒ‡ä»¤çš„åŠŸèƒ½æ˜¯è®©å››æ—‹ç¿¼åœ¨å½“å‰ä½ç½®æ‚¬åœã€‚

### 3.3 é€Ÿåº¦æŽ§åˆ¶æ–¹æ³• API
```python
def moveByVelocityZAsync(
    self,
    vx,
    vy,
    z,
    duration,
    drivetrain=DrivetrainType.MaxDegreeOfFreedom,
    yaw_mode=YawMode(),
    vehicle_name="",
)
```

### 3.4 é€Ÿåº¦æŽ§åˆ¶è¯¯å·®
å››æ—‹ç¿¼æ˜¯ä¸€ä¸ªéžçº¿æ€§ç³»ç»Ÿï¼Œç»™ä¸€ä¸ªé€Ÿåº¦æŒ‡ä»¤ï¼Œå®ƒæ˜¯ä¸å¯èƒ½çž¬æ—¶åˆ°è¾¾çš„ï¼Œè€Œä¸”è¿™ä¸ªé€Ÿåº¦æŒ‡ä»¤ä¸Žå½“å‰çš„é€Ÿåº¦ä¹‹å·®è¶Šå¤§ï¼Œè¾¾åˆ°è¿™ä¸ªé€Ÿåº¦æŒ‡ä»¤çš„è°ƒèŠ‚æ—¶é—´å°±è¶Šé•¿ã€‚æ‰€ä»¥åœ¨ä¸Šé¢çš„ç¨‹åºä¸­ï¼Œæœ€åŽçš„å››æ—‹ç¿¼å¹¶æ²¡æœ‰å›žåˆ°èµ·ç‚¹ä½ç½®ã€‚

ä¸ºäº†åšå¯¹æ¯”ï¼Œå¯ä»¥æŠŠé€Ÿåº¦å¢žå¤§ä¸€äº›ï¼Œä¸‹é¢çš„ä»£ç æ˜¯å››æ—‹ç¿¼ä»¥ 8m/s çš„é€Ÿåº¦é£žè¡Œ 2 ç§’é’Ÿï¼Œåˆ†åˆ«å‘å‰å³åŽå·¦å››ä¸ªæ–¹å‘å„é£žè¡Œä¸€æ¬¡ï¼Œæœ€åŽç¦»èµ·ç‚¹ä½ç½®åå·®æ›´å¤§ï¼š

```python
import airsim
 import time
 â€‹
 client = airsim.MultirotorClient()  # connect to the AirSim simulator
 client.enableApiControl(True)       # èŽ·å–æŽ§åˆ¶æƒ
 client.armDisarm(True)              # è§£é”
 client.takeoffAsync().join()        # ç¬¬ä¸€é˜¶æ®µï¼šèµ·é£ž
 â€‹
 client.moveToZAsync(-2, 1).join()   # ç¬¬äºŒé˜¶æ®µï¼šä¸Šå‡åˆ°2ç±³é«˜åº¦
 â€‹
 # é£žæ­£æ–¹å½¢
 client.moveByVelocityZAsync(8, 0, -2, 2).join()     # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘å‰é£ž2ç§’é’Ÿ
 client.moveByVelocityZAsync(0, 8, -2, 2).join()     # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘å³é£ž2ç§’é’Ÿ
 client.moveByVelocityZAsync(-8, 0, -2, 2).join()    # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘åŽé£ž2ç§’é’Ÿ
 client.moveByVelocityZAsync(0, -8, -2, 2).join()    # ç¬¬ä¸‰é˜¶æ®µï¼šä»¥8m/sé€Ÿåº¦å‘å·¦é£ž2ç§’é’Ÿ
 â€‹
 # æ‚¬åœ 2 ç§’é’Ÿ
 client.hoverAsync().join()          # ç¬¬å››é˜¶æ®µï¼šæ‚¬åœ6ç§’é’Ÿ
 time.sleep(6)
 â€‹
 client.landAsync().join()           # ç¬¬äº”é˜¶æ®µï¼šé™è½
 client.armDisarm(False)             # ä¸Šé”
 client.enableApiControl(False)      # é‡Šæ”¾æŽ§åˆ¶æƒ
```

## 4. å››æ—‹ç¿¼é£žåœ†å½¢åŠç”»å›¾ API
---
å››æ—‹ç¿¼é£žåœ†å½¢å’Œä¹‹å‰å°†çš„é£žæ­£æ–¹å½¢æœ‰æœ¬è´¨çš„ä¸åŒï¼Œä¸ºäº†èƒ½å¤Ÿé£žä¸€ä¸ªå®Œç¾Žçš„åœ†å½¢ï¼Œåªé é£žç‚¹æ˜¯ä¸å¤Ÿçš„ï¼Œéœ€è¦èŽ·å–æ— äººæœºå½“å‰çš„ä½ç½®çŠ¶æ€æ¥è®¡ç®—é€Ÿåº¦æŒ‡ä»¤ã€‚æŽ¥ä¸‹æ¥ä»‹ç»ä»¥é€Ÿåº¦æŒ‡ä»¤çš„æ–¹å¼ï¼Œè®©å››æ—‹ç¿¼é£žä¸€ä¸ªåœ†å½¢ã€‚

å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

```python
import airsim
import numpy as np
import math
import time

client = airsim.MultirotorClient()
client.enableApiControl(True)
client.armDisarm(True)
client.takeoffAsync().join()
client.moveToZAsync(-3, 1).join()

center = np.array([[0], [5]])   # åœ†å¿ƒè®¾ç½®
speed = 2                       # é€Ÿåº¦è®¾ç½®
radius = 5                      # åŠå¾„è®¾ç½®
clock_wise = True               # é¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆè®¾ç½®

pos_reserve = np.array([[0.], [0.], [-3.]])

# é€Ÿåº¦æŽ§åˆ¶
for i in range(2000):
    # èŽ·å–æ— äººæœºå½“å‰çš„ä½ç½®
    state = client.simGetGroundTruthKinematics()
    pos = np.array([[state.position.x_val], [state.position.y_val], [state.position.z_val]])

    # è®¡ç®—å¾„å‘é€Ÿåº¦çš„æ–¹å‘å‘é‡
    dp = pos[0:2] - center
    if np.linalg.norm(dp) - radius > 0.1:
        vel_dir_1 = -dp
    elif np.linalg.norm(dp) - radius < 0.1:
        vel_dir_1 = dp

    # è®¡ç®—åˆ‡å‘é€Ÿåº¦çš„æ–¹å‘å‘é‡
    theta = math.atan2(dp[1, 0], dp[0, 0])
    if clock_wise:
        # å¦‚æžœæ˜¯é¡ºæ—¶é’ˆ
        theta += math.pi/2
    else:
        # å¦‚æžœæ˜¯é€†æ—¶é’ˆ
        theta -= math.pi/2
    v_dir_2 = np.array([[math.cos(theta)], [math.sin(theta)]])

    # è®¡ç®—æœ€ç»ˆé€Ÿåº¦çš„æ–¹å‘å‘é‡
    v_dir = 0.08 * vel_dir_1 + v_dir_2

    # è®¡ç®—æœ€ç»ˆé€Ÿåº¦æŒ‡ä»¤
    v_cmd = speed * v_dir/np.linalg.norm(v_dir)

    # é€Ÿåº¦æŽ§åˆ¶
    client.moveByVelocityZAsync(v_cmd[0, 0], v_cmd[1, 0], -3, 1)

    # ç”»å›¾
    point_reserve = [airsim.Vector3r(pos_reserve[0, 0], pos_reserve[1, 0], pos_reserve[2, 0])]
    point = [airsim.Vector3r(pos[0, 0], pos[1, 0], pos[2, 0])]
    point_end = pos + np.vstack((v_cmd, np.array([[0]])))
    point_end = [airsim.Vector3r(point_end[0, 0], point_end[1, 0], point_end[2, 0])]
    client.simPlotArrows(point, point_end, arrow_size=8.0, color_rgba=[0.0, 0.0, 1.0, 1.0])
    client.simPlotLineList(point_reserve+point, color_rgba=[1.0, 0.0, 0.0, 1.0], is_persistent=True)

    # å¾ªçŽ¯
    pos_reserve = pos
    time.sleep(0.02)
```

- **ç¬¬ä¸€æ­¥**ï¼šè®¡ç®—å¾„å‘é€Ÿåº¦å‘é‡æ–¹å‘
    è®¡ç®—å‘é‡çš„æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯ä¸ç”¨ç®¡å¤§å°æ˜¯å¤šå°‘ï¼Œåªè¦å‘é‡æ–¹å‘æ­£ç¡®å³å¯ã€‚

    å› ä¸ºæ— äººæœºå¾ˆå¯èƒ½å¹¶æ²¡æœ‰åœ¨åœ†å‘¨ä¸Šï¼Œæ‰€ä»¥è¦ç»™å®ƒå¾„å‘çš„æŒ‡ä»¤ï¼Œæ¥é™åˆ¶å®ƒåœ¨åœ†å‘¨ä¸Šè¿åŠ¨ï¼Œä¸èƒ½åç¦»å¤ªè¿œã€‚
- **ç¬¬äºŒæ­¥**ï¼šè®¡ç®—åˆ‡å‘é€Ÿåº¦å‘é‡æ–¹å‘
    åˆ‡å‘é€Ÿåº¦å‘é‡è®¡ç®—æˆ‘æ˜¯å…ˆæ±‚çš„å½“å‰æ–¹ä½è§’ï¼ˆç›¸å¯¹äºŽåœ†å¿ƒçš„ï¼‰ï¼Œç„¶åŽåŠ ï¼ˆæˆ–å‡ï¼‰90 åº¦ï¼Œå¾—åˆ°çš„å‘é‡ã€‚

- **ç¬¬ä¸‰æ­¥**ï¼šä¸¤ä¸ªå‘é‡åŠ æƒç›¸åŠ å¹¶å•ä½åŒ–ï¼Œå¾—åˆ°æœ€ç»ˆå•ä½é€Ÿåº¦æ–¹å‘å‘é‡
    ä¸¤ä¸ªå‘é‡åŠ æƒå¹³å‡ï¼Œk å€¼æ˜¯éœ€è¦è°ƒèŠ‚çš„ï¼Œè¿™æ ·æ›²çº¿æ‰åœ†æ¶¦ã€‚

- **ç¬¬å››æ­¥**ï¼šå•ä½å‘é‡ä¹˜é€Ÿåº¦ï¼Œå°±æ˜¯æœ€ç»ˆé€Ÿåº¦æŒ‡ä»¤

