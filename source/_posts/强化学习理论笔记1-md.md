---
title: æ·±åº¦å­¦ä¹ ä¸ PyTorch å…¥é—¨æŒ‡å—
date: 2024-11-27 00:37:44
tags:
    - PyTorch
    - æ·±åº¦å­¦ä¹ 
categories:
    - æ‚è°ˆ
description: |
    ç®€å•ä»‹ç»æ·±åº¦å­¦ä¹ ï¼Œå¹¶ç®€å•è®²è§£PyTorchçš„åŸºæœ¬è¯­æ³•
---
> æœ¬æ–‡æ˜¯æˆ‘ä¸ºäº†æˆè¯¾è€Œç¼–å†™çš„ä¸€ç¯‡æ–‡æ¡£ï¼Œå¯ä»¥ä½œä¸ºä¸€é—¨å¼•å¯¼è¯¾ç¨‹ä¾›å°šæœªäº†è§£æ·±åº¦å­¦ä¹ çš„æ–°äººå­¦ä¹ 
> è€ƒè™‘åˆ°æ—¶é—´é—®é¢˜ï¼Œæœ¬æ–‡æ¡£å†…å®¹è¾ƒä¸ºç®€ç•¥ï¼Œåªé€‚ç”¨äºäº†è§£æ·±åº¦å­¦ä¹ ä¸ PyTorchï¼Œæ­£å¸¸å­¦ä¹ è¯·å‚è€ƒè§†é¢‘ç½‘ç«™ğŸ“½æˆ–ç½‘ç»œæ•™ç¨‹ğŸ’»ä¸ä¹¦ç±ğŸ“–

# 1. æ·±åº¦å­¦ä¹ éƒ¨åˆ†
## 1.1 æ·±åº¦å­¦ä¹ æ˜¯ä»€ä¹ˆï¼Ÿ
![deep-learning](./images/class/deep-learning.png)

æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ ä¸‹çš„ä¸€ä¸ªåŸºäºæ·±åº¦ç¥ç»ç½‘ç»œçš„æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œèƒ½å¤Ÿä»æµ·é‡æ•°æ®å’ŒçŸ¥è¯†ä¸­å­¦ä¹ ï¼Œä»è€Œä¸€å®šç¨‹åº¦ä¸Šå…·å¤‡äº†äººçš„èƒ½åŠ›ã€‚

![nn](./images/class/nn.png)

æ·±åº¦å­¦ä¹ æ˜¯ä¸€ç§ç»“æ„å¯å‘çš„æœºå™¨å­¦ä¹ ï¼Œäººè„‘åœ¨æ·±åº¦å­¦ä¹ æ–¹é¢çš„ç»“æ„ï¼Œè¢«ç§°ä¸ºäººå·¥ç¥ç»ç½‘ç»œ


# 2. PyTorch ç®€ä»‹
## 2.1 ä»€ä¹ˆæ˜¯ PyTorchâ“
PyTorch æ˜¯å½“ä¸‹æœ€çƒ­é—¨çš„å¼€æºæœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ æ¡†æ¶ã€‚
## 2.2 PyTorch å¯ä»¥åšä»€ä¹ˆå‘¢â“
PyTorch å…è®¸ä½ ä½¿ç”¨ Python ä»£ç æ¥æ“ä½œå’Œå¤„ç†æ•°æ®ï¼Œå¹¶ç¼–å†™æœºå™¨å­¦ä¹ ç®—æ³•ã€‚
## 2.3 æœ‰å“ªäº›äººåœ¨ä½¿ç”¨å®ƒå‘¢â“
è®¸å¤šä¸–ç•Œä¸Šæœ€å¤§çš„ç§‘æŠ€å…¬å¸ï¼Œæ¯”å¦‚[Metaï¼ˆFacebookï¼‰](https://ai.facebook.com/blog/pytorch-builds-the-future-of-ai-and-machine-learning-at-facebook/)ã€ç‰¹æ–¯æ‹‰å’Œå¾®è½¯ï¼Œä»¥åŠäººå·¥æ™ºèƒ½ç ”ç©¶å…¬å¸å¦‚[OpenAI](https://openai.com/blog/openai-pytorch/)ï¼Œéƒ½ä½¿ç”¨PyTorchæ¥æ¨åŠ¨ç ”ç©¶å¹¶å°†æœºå™¨å­¦ä¹ åº”ç”¨åˆ°ä»–ä»¬çš„äº§å“ä¸­ã€‚

ä¾‹å¦‚ï¼ŒAndrej Karpathyï¼ˆç‰¹æ–¯æ‹‰çš„äººå·¥æ™ºèƒ½è´Ÿè´£äººï¼‰åœ¨å¤šä¸ªæ¼”è®²ä¸­ï¼ˆ[PyTorch DevCon 2019](https://youtu.be/oBklltKXtDE)ï¼Œ[ç‰¹æ–¯æ‹‰AIæ—¥2021](https://youtu.be/j0z4FweCy4M?t=2904)ï¼‰è®¨è®ºäº†ç‰¹æ–¯æ‹‰å¦‚ä½•ä½¿ç”¨PyTorchæ¥é©±åŠ¨ä»–ä»¬çš„è‡ªåŠ¨é©¾é©¶è®¡ç®—æœºè§†è§‰æ¨¡å‹ã€‚

æ­¤å¤–ï¼ŒPyTorchä¹Ÿè¢«ç”¨äºå…¶ä»–å„ä¸ªè¡Œä¸šï¼Œæ¯”å¦‚å†œä¸šï¼Œç”¨äº[åœ¨æ‹–æ‹‰æœºä¸Šå®ç°è®¡ç®—æœºè§†è§‰](https://medium.com/pytorch/ai-for-ag-production-machine-learning-for-agriculture-e8cfdb9849a1)ã€‚
## 2.4 ä¸ºä»€ä¹ˆé€‰æ‹© PyTorchâ“
ç›¸æ¯”äºè¿‡å»çƒ­é—¨çš„ TensorFlow æ¡†æ¶ï¼Œå¦‚ä»Šçš„æœºå™¨å­¦ä¹ ç ”ç©¶è€…é—¨æ›´å€¾å‘äºä½¿ç”¨ PyTorch ã€‚æˆªè‡³2022å¹´2æœˆï¼Œ PyTorch æ˜¯ [Papers With Code](https://paperswithcode.com/trends) ä¸Šä½¿ç”¨æœ€å¤šçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œè¿™æ˜¯ä¸€ä¸ªè·Ÿè¸ªæœºå™¨å­¦ä¹ ç ”ç©¶è®ºæ–‡åŠå…¶é™„å¸¦ä»£ç åº“çš„ç½‘ç«™ã€‚

PyTorch æ¡†æ¶è¿˜å¸®åŠ©å¤„ç†è®¸å¤šäº‹æƒ…ï¼Œæ¯”å¦‚è°ƒç”¨ GPU åŠ é€Ÿï¼ˆè®©æ‚¨çš„ä»£ç è¿è¡Œå¾—æ›´å¿«ï¼‰ï¼Œè¿™äº›éƒ½æ˜¯åœ¨åå°è‡ªåŠ¨å®Œæˆçš„ã€‚

å› æ­¤ï¼Œåœ¨ PyTorch æ¡†æ¶ä¸‹ï¼Œä½ å¯ä»¥ä¸“æ³¨äºæ“ä½œæ•°æ®å’Œç¼–å†™ç®—æ³•ï¼Œå…¶ä»–ç¹ççš„æ“ä½œéƒ½å¯ä»¥ç”± PyTorch è‡ªåŠ¨å®Œæˆï¼ˆå¦‚æ¢¯åº¦è®¡ç®—ã€æƒé‡æ›´æ–°ç­‰ï¼‰

å¦‚æœåƒç‰¹æ–¯æ‹‰å’Œ Metaï¼ˆFacebookï¼‰ è¿™æ ·çš„å…¬å¸ä½¿ç”¨å®ƒæ¥æ„å»ºä»–ä»¬éƒ¨ç½²çš„æ¨¡å‹ï¼Œä»¥é©±åŠ¨æ•°ç™¾ä¸ªåº”ç”¨ã€é©±åŠ¨æ•°åƒè¾†æ±½è½¦å’Œå‘æ•°åäº¿äººæä¾›å†…å®¹ï¼Œé‚£ä¹ˆå®ƒåœ¨å¼€å‘æ–¹é¢æ˜¾ç„¶ä¹Ÿæ˜¯èƒ½åŠ›å‡ºä¼—çš„ã€‚

## 2.5 æˆ‘ä»¬å°†åœ¨æœ¬èŠ‚è¯¾ä¸­è®²è§£å“ªäº›å†…å®¹â“
| **ä¸»é¢˜** | **å†…å®¹** |
| ----- | ----- |
| **æ·±åº¦å­¦ä¹ ç®€ä»‹** | ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹  |
| **å¼ é‡ç®€ä»‹** | å¼ é‡æ˜¯æ‰€æœ‰æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŸºæœ¬æ„å»ºå—ã€‚ |
| **åˆ›å»ºå¼ é‡** | å¼ é‡å¯ä»¥è¡¨ç¤ºå‡ ä¹æ‰€æœ‰ç±»å‹çš„æ•°æ®ï¼ˆå›¾åƒã€æ–‡å­—ã€æ•°å­—è¡¨æ ¼ï¼‰ã€‚ |
| **ä»å¼ é‡ä¸­è·å–ä¿¡æ¯** | å¦‚æœä½ å¯ä»¥å°†ä¿¡æ¯æ”¾å…¥å¼ é‡ï¼Œä½ ä¹Ÿä¼šæƒ³è¦å°†å…¶å–å‡ºã€‚ |
| **æ“ä½œå¼ é‡** | æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆå¦‚ç¥ç»ç½‘ç»œï¼‰æ¶‰åŠä»¥å¤šç§ä¸åŒæ–¹å¼æ“ä½œå¼ é‡ï¼Œä¾‹å¦‚æ·»åŠ ã€ä¹˜æ³•ã€ç»„åˆã€‚ |
| **å¤„ç†å¼ é‡å½¢çŠ¶** | æœºå™¨å­¦ä¹ ä¸­æœ€å¸¸è§é—®é¢˜ä¹‹ä¸€æ˜¯å¤„ç†å½¢çŠ¶ä¸åŒ¹é…ï¼ˆå°è¯•å°†å½¢çŠ¶é”™è¯¯çš„å¼ é‡ä¸å…¶ä»–å¼ é‡æ··åˆï¼‰ã€‚ |
| **å¼ é‡ç´¢å¼•** | å¦‚æœä½ æ›¾åœ¨Pythonåˆ—è¡¨æˆ–NumPyæ•°ç»„ä¸Šè¿›è¡Œè¿‡ç´¢å¼•ï¼Œé‚£ä¹ˆåœ¨å¼ é‡ä¸Šçš„æ“ä½œéå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¼ é‡å¯ä»¥æœ‰æ›´å¤šçš„ç»´åº¦ã€‚ |
| **æ··åˆPyTorchå¼ é‡å’ŒNumPy** | PyTorchä½¿ç”¨å¼ é‡ï¼ˆ[`torch.Tensor`](https://pytorch.org/docs/stable/tensors.html)ï¼‰ï¼ŒNumPyå–œæ¬¢æ•°ç»„ï¼ˆ[`np.ndarray`](https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html)ï¼‰ï¼Œæœ‰æ—¶ä½ å¯èƒ½æƒ³è¦æ··åˆä½¿ç”¨è¿™äº›ã€‚ |
| **å¯å¤ç°æ€§** | æœºå™¨å­¦ä¹ éå¸¸å®éªŒæ€§ï¼Œå› ä¸ºå®ƒä½¿ç”¨å¤§é‡çš„*éšæœºæ€§*æ¥å·¥ä½œï¼Œæœ‰æ—¶ä½ å¯èƒ½å¸Œæœ›è¿™ç§*éšæœºæ€§*ä¸è¦å¤ªéšæœºã€‚ |
| **åœ¨GPUä¸Šè¿è¡Œå¼ é‡** | GPUï¼ˆå›¾å½¢å¤„ç†å•å…ƒï¼‰å¯ä»¥ä½¿ä½ çš„ä»£ç æ›´å¿«ï¼ŒPyTorchä½¿å¾—åœ¨GPUä¸Šè¿è¡Œä½ çš„ä»£ç å˜å¾—ç®€å•ã€‚ |

# 3. PyTorch åŸºæœ¬ç”¨æ³•
## 3.1 å¼•å…¥ PyTorch
> **æ³¨æ„ï¼š** åœ¨è¿è¡Œè¿™ä¸ªç¬”è®°æœ¬ä¸­çš„ä»»ä½•ä»£ç ä¹‹å‰ï¼Œä½ åº”è¯¥å·²ç»å®Œæˆäº†[PyTorchå®‰è£…æ­¥éª¤](https://pytorch.org/get-started/locally/)ã€‚
>
> ç„¶è€Œï¼Œ**å¦‚æœä½ åœ¨Google Colabä¸Šè¿è¡Œ**ï¼Œä¸€åˆ‡éƒ½åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œï¼ˆGoogle Colabè‡ªå¸¦PyTorchå’Œå…¶ä»–åº“çš„å®‰è£…ï¼‰ã€‚

```python
import torch

# æ£€æŸ¥èƒ½å¦è°ƒç”¨ cuda
print(torch.cuda.is_available())

# è¾“å‡º PyTorch ç‰ˆæœ¬
print(torch.__version__)
```

å¦‚æœè°ƒç”¨ `is_available()` è¾“å‡ºçš„ç»“æœä¸º `True` ï¼Œåˆ™è¯´æ˜ PyTorch å®‰è£…æˆåŠŸä¸”å¯ä»¥æ­£å¸¸è°ƒç”¨ cuda

è¿™é‡Œ `torch.__version__` è¾“å‡ºäº†æˆ‘ä»¬å®‰è£…çš„ PyTorch çš„ç‰ˆæœ¬ã€‚æˆ‘è¿™é‡Œè¾“å‡ºçš„ç‰ˆæœ¬ä¸º `2.5.0` ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒPyTorch é«˜ç‰ˆæœ¬å¯¹ä½ç‰ˆæœ¬å…·æœ‰å‘ä¸‹å…¼å®¹æ€§ï¼Œä½†æ³¨æ„ï¼šPyTorch `2.X.X` ç³»åˆ—ç‰ˆæœ¬ä¸ `1.X.X` ç³»åˆ—ç‰ˆæœ¬æ›´èƒ½å·®åˆ«è¾ƒå¤§ã€‚

## 3.2 ä»€ä¹ˆæ˜¯å¼ é‡â“
ç°åœ¨æˆ‘ä»¬å·²ç»å¯¼å…¥äº† PyTorch,æ˜¯æ—¶å€™å­¦ä¹ å…³äºå¼ é‡çš„çŸ¥è¯†äº†ğŸ“š

å¼ é‡æ˜¯æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ„å»ºå—ï¼Œå®ƒä»¬çš„ä»»åŠ¡æ˜¯ä»¥æ•°å€¼çš„æ–¹å¼è¡¨ç¤ºæ•°æ®ã€‚

ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†ä¸€å¼ å›¾åƒè¡¨ç¤ºä¸ºå½¢çŠ¶ä¸º `[3, 224, 224]` çš„å¼ é‡ï¼Œè¿™æ„å‘³ç€ `[é¢œè‰²é€šé“ï¼Œé«˜åº¦ï¼Œå®½åº¦]` ï¼Œå³å›¾åƒæœ‰3ä¸ªé¢œè‰²é€šé“ï¼ˆçº¢è‰²ã€ç»¿è‰²ã€è“è‰²ï¼‰ï¼Œé«˜åº¦ä¸º224åƒç´ ï¼Œå®½åº¦ä¸º224åƒç´ ã€‚

åœ¨å¼ é‡æœ¯è¯­ï¼ˆç”¨äºæè¿°å¼ é‡çš„å®šä¹‰ï¼‰ä¸­ï¼Œè¯¥å¼ é‡æœ‰ä¸‰ä¸ªç»´åº¦ï¼Œåˆ†åˆ«å¯¹åº”é¢œè‰²é€šé“ã€é«˜åº¦å’Œå®½åº¦ã€‚

> å¦‚æœæƒ³è¦äº†è§£æ›´å¤šå…³äºå¼ é‡çš„ç†è®ºçŸ¥è¯†ï¼Œè¯·è‡ªè¡ŒæŸ¥æ‰¾**çº¿æ€§ä»£æ•°**ç›¸å…³èµ„æ–™å­¦ä¹ ğŸ“š
> 
>è¿™é‡Œæˆ‘ä»¬ä¸å…·ä½“è®²è§£ç†è®ºçŸ¥è¯†ï¼Œå„ä½ç†è§£å³å¯ã€‚

ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç æ¥ç†è§£å¼ é‡ã€‚
## 3.3 åœ¨ PyTorch ä¸­åˆ›å»ºå¼ é‡
PyTorchéå¸¸å–œæ¬¢å¼ é‡ã€‚ä»¥è‡³äºæœ‰ä¸€ä¸ªå®Œæ•´çš„æ–‡æ¡£é¡µé¢ä¸“é—¨ä»‹ç»[`torch.Tensor`](https://pytorch.org/docs/stable/tensors.html)ç±»ã€‚

ä½ çš„ç¬¬ä¸€é¡¹å®¶åº­ä½œä¸šæ˜¯[é˜…è¯»`torch.Tensor`çš„æ–‡æ¡£](https://pytorch.org/docs/stable/tensors.html)10åˆ†é’Ÿã€‚ä½†ä½ å¯ä»¥åœ¨ç¨åè¿›è¡Œã€‚

è®©æˆ‘ä»¬å¼€å§‹ç¼–ç ã€‚
### 3.3.1 æ ‡é‡
æˆ‘ä»¬é¦–å…ˆå°†è¦åˆ›å»ºçš„æ˜¯ä¸€ä¸ª**æ ‡é‡**ã€‚

æ ‡é‡æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ•°å­—ï¼Œåœ¨å¼ é‡æœ¯è¯­ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªé›¶ç»´å¼ é‡ã€‚

> **æ³¨æ„ï¼š** è¿™æ˜¯æœ¬è¯¾ç¨‹çš„ä¸€ä¸ªè¶‹åŠ¿ã€‚æˆ‘ä»¬å°†ä¸“æ³¨äºç¼–å†™ç‰¹å®šçš„ä»£ç ã€‚ä½†é€šå¸¸æˆ‘ä¼šè®¾ç½®ä¸€äº›ç»ƒä¹ ï¼Œæ¶‰åŠé˜…è¯»å’Œç†Ÿæ‚‰PyTorchæ–‡æ¡£ã€‚æ¯•ç«Ÿï¼Œä¸€æ—¦ä½ å®Œæˆäº†è¿™ä¸ªè¯¾ç¨‹ï¼Œä½ æ— ç–‘ä¼šæƒ³è¦å­¦ä¹ æ›´å¤šã€‚è€Œæ–‡æ¡£æ˜¯ä½ ç»å¸¸ä¼šå»æŸ¥æ‰¾çš„åœ°æ–¹ã€‚

```Python
# Scalar
scalar = torch.tensor(7)
print(scalar)
```
çœ‹åˆ°ä¸Šé¢æ‰“å°å‡ºçš„`tensor(7)`äº†å—ï¼Ÿ

è¿™æ„å‘³ç€å°½ç®¡ `scalar` æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ•°å­—ï¼Œä½†å®ƒçš„ç±»å‹æ˜¯ `torch.Tensor`ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `ndim` å±æ€§æ¥æ£€æŸ¥å¼ é‡çš„ç»´åº¦ã€‚

```Python
print(scalar.ndim)
```
å¦‚æœæˆ‘ä»¬æƒ³è¦ä»å¼ é‡ä¸­æ£€ç´¢æ•°å­—å‘¢ï¼Ÿ

æ¯”å¦‚ï¼Œå°†å…¶ä» `torch.Tensor` è½¬æ¢ä¸ºPythonæ•´æ•°ï¼Ÿ

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `item()` æ–¹æ³•ã€‚

```Python
print(scalar.item())
```
### 3.3.2 å‘é‡
å¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª**å‘é‡**ã€‚

å‘é‡æ˜¯ä¸€ç§å•ç»´åº¦çš„å¼ é‡ï¼Œä½†å®ƒå¯ä»¥åŒ…å«è®¸å¤šæ•°å­—ã€‚

æ¯”å¦‚ï¼Œä½ å¯ä»¥æœ‰ä¸€ä¸ªå‘é‡ `[3, 2]` æ¥æè¿°ä½ æˆ¿å­é‡Œçš„ `[å§å®¤ï¼Œæµ´å®¤]` æ•°é‡ã€‚æˆ–è€…ä½ å¯ä»¥æœ‰ä¸€ä¸ª `[3, 2, 2]` æ¥æè¿°ä½ æˆ¿å­é‡Œçš„ `[å§å®¤ï¼Œæµ´å®¤ï¼Œè½¦ä½]` æ•°é‡ã€‚

è¿™é‡Œçš„é‡è¦è¶‹åŠ¿æ˜¯å‘é‡åœ¨å®ƒæ‰€èƒ½ä»£è¡¨çš„å†…å®¹ä¸Šæ˜¯çµæ´»çš„ï¼ˆå’Œå¼ é‡ä¸€æ ·ï¼‰ã€‚

```Python
# vector
vector = torch.tensor([7, 7])
print(vector)
```
æ¯«å¾·ï¼Œ`vector` ç°åœ¨åŒ…å«äº†ä¸¤ä¸ª7ã€‚

ä½ è®¤ä¸ºå®ƒå°†æœ‰å¤šå°‘ä¸ªç»´åº¦ï¼Ÿ

```Python
print(vector.ndim)
```
å—¯ï¼Œè¿™æœ‰ç‚¹å¥‡æ€ªï¼Œ`vector` åŒ…å«äº†ä¸¤ä¸ªæ•°å­—ï¼Œä½†åªæœ‰ä¸€ä¸ªç»´åº¦ã€‚

æˆ‘æ¥å‘Šè¯‰ä½ ä¸€ä¸ªçªé—¨ã€‚

ä½ å¯ä»¥é€šè¿‡å¤–éƒ¨çš„æ–¹æ‹¬å·æ•°é‡ï¼ˆ`[`ï¼‰æ¥åˆ¤æ–­PyTorchä¸­å¼ é‡çš„ç»´åº¦ï¼Œä½ åªéœ€è¦æ•°ä¸€è¾¹çš„æ–¹æ‹¬å·æ•°é‡ã€‚

`vector` æœ‰å¤šå°‘ä¸ªæ–¹æ‹¬å·ï¼Ÿ

å¦ä¸€ä¸ªå¯¹å¼ é‡æ¥è¯´é‡è¦çš„æ¦‚å¿µæ˜¯å®ƒä»¬çš„ `shape` å±æ€§ã€‚`shape` å‘Šè¯‰ä½ å®ƒä»¬å†…éƒ¨çš„å…ƒç´ æ˜¯å¦‚ä½•æ’åˆ—çš„ã€‚

è®©æˆ‘ä»¬æ¥æ£€æŸ¥ä¸€ä¸‹ `vector` çš„å½¢çŠ¶ã€‚

```Python
print(vector.shape)
```

ä¸Šè¿°è¿”å› `torch.Size([2])` ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„å‘é‡çš„å½¢çŠ¶æ˜¯ `[2]` ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æŠŠä¸¤ä¸ªå…ƒç´ æ”¾åœ¨äº†æ–¹æ‹¬å·å†…éƒ¨ï¼ˆ`[7, 7]`ï¼‰ã€‚

### 3.3.3 çŸ©é˜µ
ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª**çŸ©é˜µ**ã€‚
```Python
matrix = torch.tensor([[7, 8],
                       [9, 10]])
print(matrix)
```
çŸ©é˜µå’Œå‘é‡ä¸€æ ·çµæ´»ï¼Œåªæ˜¯å®ƒä»¬å¤šäº†ä¸€ä¸ªç»´åº¦ã€‚
```Python
print(matrix.ndim)
```
`matrix` æœ‰ä¸¤ä¸ªç»´åº¦ï¼ˆä½ æ•°äº†ä¸€è¾¹å¤–éƒ¨çš„æ–¹æ‹¬å·æ•°é‡äº†å—ï¼Ÿï¼‰ã€‚

ä½ è®¤ä¸ºå®ƒå°†å…·æœ‰ä»€ä¹ˆæ ·çš„`shape`ï¼Ÿ
```Python
print(matrix.shape)
```
æˆ‘ä»¬å¾—åˆ°çš„è¾“å‡ºæ˜¯ `torch.Size([2, 2])`ï¼Œå› ä¸º `matrix` æ·±åº¦ä¸ºä¸¤ä¸ªå…ƒç´ ï¼Œå®½åº¦ä¹Ÿä¸ºä¸¤ä¸ªå…ƒç´ ã€‚

é‚£ä¹ˆæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª**å¼ é‡**æ€ä¹ˆæ ·ï¼Ÿ

```Python
tensor = torch.tensor([[[1, 2, 3],
                        [3, 6, 9],
                        [2, 4, 5]]])
print(tensor)
```
è¿™ä¸ªå¼ é‡çœ‹èµ·æ¥çœŸä¸é”™ã€‚

>å¼ é‡å‡ ä¹å¯ä»¥ä»£è¡¨ä»»ä½•ä¸œè¥¿ã€‚

ä½ è®¤ä¸ºå®ƒæœ‰å¤šå°‘ä¸ªç»´åº¦ï¼Ÿï¼ˆæç¤ºï¼šä½¿ç”¨æ–¹æ‹¬å·è®¡æ•°æŠ€å·§ï¼‰
```Python
print(tensor.ndim)
```
é‚£ä¹ˆå®ƒæœ‰ç€ä»€ä¹ˆæ ·çš„ `shape` å‘¢ï¼Ÿ
```Python
print(tensor.shape)
```
å¥½çš„ï¼Œè¾“å‡ºæ˜¯ `torch.Size([1, 3, 3])`ã€‚

ç»´åº¦æ˜¯ä»å¤–å‘å†…æ’åˆ—çš„ã€‚

è¿™æ„å‘³ç€æœ‰ä¸€ä¸ª3ä¹˜3çš„ç»´åº¦ã€‚

è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ã€‚

| åç§° | å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ | ç»´åº¦æ•°é‡ | é€šå¸¸/ç¤ºä¾‹æ˜¯å°å†™è¿˜æ˜¯å¤§å†™ |
| ----- | ----- | ----- | ----- |
| **æ ‡é‡ï¼ˆscalarï¼‰** | ä¸€ä¸ªå•ç‹¬çš„æ•°å­— | 0 | å°å†™ï¼ˆ`a`ï¼‰ | 
| **å‘é‡ï¼ˆvectorï¼‰** | æœ‰æ–¹å‘çš„æ•°å­—ï¼ˆä¾‹å¦‚é£é€Ÿå’Œæ–¹å‘ï¼‰ä½†ä¹Ÿå¯èƒ½æœ‰å…¶ä»–è®¸å¤šæ•°å­— | 1 | å°å†™ï¼ˆ`y`ï¼‰ |
| **çŸ©é˜µï¼ˆmatrixï¼‰** | ä¸€ä¸ªäºŒç»´æ•°ç»„ | 2 | å¤§å†™ï¼ˆ`Q`ï¼‰ |
| **å¼ é‡ï¼ˆtensorï¼‰** | ä¸€ä¸ªnç»´æ•°ç»„ | å¯ä»¥æ˜¯ä»»ä½•æ•°é‡ï¼Œ0ç»´å¼ é‡æ˜¯æ ‡é‡ï¼Œ1ç»´å¼ é‡æ˜¯å‘é‡ | å¤§å†™ï¼ˆ`X`ï¼‰ |
## 3.4 éšæœºå¼ é‡

æˆ‘ä»¬å·²ç»ç¡®å®šå¼ é‡ä»£è¡¨äº†æŸç§å½¢å¼çš„æ•°æ®ã€‚

æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæ¯”å¦‚ç¥ç»ç½‘ç»œï¼Œä¼šæ“ä½œå¼ é‡å¹¶åœ¨å…¶ä¸­å¯»æ‰¾æ¨¡å¼ã€‚

ä½†åœ¨ä½¿ç”¨PyTorchæ„å»ºæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ï¼Œä½ å¾ˆå°‘ä¼šæ‰‹å·¥åˆ›å»ºå¼ é‡ï¼ˆå°±åƒæˆ‘ä»¬ä¹‹å‰æ‰€åšçš„é‚£æ ·ï¼‰ã€‚

ç›¸åï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹é€šå¸¸ä»å¤§é‡çš„éšæœºæ•°å¼ é‡å¼€å§‹ï¼Œå¹¶åœ¨å¤„ç†æ•°æ®æ—¶è°ƒæ•´è¿™äº›éšæœºæ•°ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¡¨ç¤ºæ•°æ®ã€‚

æœ¬è´¨ä¸Šæ˜¯ï¼š

`ä»éšæœºæ•°å¼€å§‹ -> æŸ¥çœ‹æ•°æ® -> æ›´æ–°éšæœºæ•° -> æŸ¥çœ‹æ•°æ® -> æ›´æ–°éšæœºæ•°...`

ä½œä¸ºæ•°æ®ç§‘å­¦å®¶ï¼Œä½ å¯ä»¥å®šä¹‰æœºå™¨å­¦ä¹ æ¨¡å‹å¦‚ä½•å¼€å§‹ï¼ˆåˆå§‹åŒ–ï¼‰ã€æŸ¥çœ‹æ•°æ®ï¼ˆè¡¨ç¤ºï¼‰ä»¥åŠæ›´æ–°ï¼ˆä¼˜åŒ–ï¼‰å…¶éšæœºæ•°ã€‚

æˆ‘ä»¬ç¨åå°†äº²èº«å®è·µè¿™äº›æ­¥éª¤ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ›å»ºä¸€ä¸ªéšæœºæ•°å¼ é‡ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ [`torch.rand()`](https://pytorch.org/docs/stable/generated/torch.rand.html) å¹¶ä¼ å…¥ `size` å‚æ•°æ¥å®ç°ã€‚

```Python
random_tensor = torch.rand(size=(3, 4))
print(random_tensor)
print(random_tensor.dtype)
```
`torch.rand()` çš„çµæ´»æ€§åœ¨äºæˆ‘ä»¬å¯ä»¥è°ƒæ•´ `size` å‚æ•°ä¸ºä»»ä½•æˆ‘ä»¬æƒ³è¦çš„å€¼ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³è¦ä¸€ä¸ªå¸¸è§å›¾åƒå½¢çŠ¶çš„éšæœºå¼ é‡ `[224, 224, 3]`ï¼ˆ`[é«˜åº¦ï¼Œå®½åº¦ï¼Œé¢œè‰²é€šé“]`ï¼‰ã€‚

```Python
random_image_size_tensor = torch.rand(size=(224, 224, 3))
print(random_image_size_tensor.shape)
print(random_image_size_tensor.ndim)
```
## 3.5 é›¶ä¸€å¼ é‡

æœ‰æ—¶å€™ä½ å¯èƒ½åªæƒ³ç”¨é›¶æˆ–ä¸€æ¥å¡«å……å¼ é‡ã€‚

è¿™ç§æƒ…å†µåœ¨æ©ç æ“ä½œä¸­å¾ˆå¸¸è§ï¼ˆæ¯”å¦‚ç”¨é›¶æ©ç ä¸€ä¸ªå¼ é‡ä¸­çš„ä¸€äº›å€¼ï¼Œä»¥è®©æ¨¡å‹çŸ¥é“ä¸è¦å­¦ä¹ è¿™äº›å€¼ï¼‰ã€‚

è®©æˆ‘ä»¬ä½¿ç”¨ [`torch.zeros()`](https://pytorch.org/docs/stable/generated/torch.zeros.html) åˆ›å»ºä¸€ä¸ªå…¨é›¶çš„å¼ é‡ã€‚

åŒæ ·ï¼Œ`size` å‚æ•°åœ¨è¿™é‡Œèµ·ä½œç”¨ã€‚

``` Python
zeros = torch.zeros(size=(3, 4))
print(zeros)
print(zeros.dtype)
```

æˆ‘ä»¬å¯ä»¥åšåŒæ ·çš„äº‹æƒ…æ¥åˆ›å»ºä¸€ä¸ªå…¨ä¸€çš„å¼ é‡ï¼Œåªæ˜¯ä½¿ç”¨ [`torch.ones()`](https://pytorch.org/docs/stable/generated/torch.ones.html) ä»£æ›¿ã€‚

ä½¿ç”¨ `torch.ones()` å‡½æ•°æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡æŒ‡å®š `size` å‚æ•°æ¥åˆ›å»ºä¸€ä¸ªæŒ‡å®šå½¢çŠ¶çš„å¼ é‡ï¼Œå…¶ä¸­æ‰€æœ‰å…ƒç´ éƒ½æ˜¯1ã€‚
```Python
ones = torch.ones(size=(3, 4))
print(ones)
print(ones.dtype)
```
## 3.6 åˆ›å»ºä¸€ä¸ªèŒƒå›´å’Œç±»ä¼¼çš„å¼ é‡

æœ‰æ—¶å€™ä½ å¯èƒ½æƒ³è¦ä¸€ç³»åˆ—æ•°å­—ï¼Œæ¯”å¦‚ä»1åˆ°10æˆ–è€…ä»0åˆ°100ã€‚

ä½ å¯ä»¥ä½¿ç”¨ `torch.arange(start, end, step)` æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

å…¶ä¸­ï¼š
* `start` = èŒƒå›´çš„å¼€å§‹ï¼ˆä¾‹å¦‚ 0ï¼‰
* `end` = èŒƒå›´çš„ç»“æŸï¼ˆä¾‹å¦‚ 10ï¼‰
* `step` = æ¯ä¸ªå€¼ä¹‹é—´çš„æ­¥é•¿ï¼ˆä¾‹å¦‚ 1ï¼‰

> **æ³¨æ„ï¼š** åœ¨Pythonä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `range()` æ¥åˆ›å»ºä¸€ä¸ªèŒƒå›´ã€‚ç„¶è€Œåœ¨PyTorchä¸­ï¼Œ`torch.range()` å·²ç»è¢«å¼ƒç”¨ï¼Œå¯èƒ½ä¼šæ˜¾ç¤ºé”™è¯¯ã€‚

```Python
# ä¸‹é¢è¿™ä¸€è¡Œä»£ç å¯èƒ½ä¼šæŠ¥é”™
zero_to_ten_deprecated = torch.range(0, 10)

# å»ºè®®ç”¨ä¸‹é¢è¿™ä¸€è¡Œ
zero_to_ten = torch.arange(start=0, end=10, step=1)
print(zero_to_ten)
```
æœ‰æ—¶å€™ä½ å¯èƒ½æƒ³è¦ä¸€ä¸ªä¸å¦ä¸€ä¸ªå¼ é‡å½¢çŠ¶ç›¸åŒçš„ç‰¹å®šç±»å‹çš„å¼ é‡ã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ªä¸ä¹‹å‰å¼ é‡å½¢çŠ¶ç›¸åŒçš„å…¨é›¶å¼ é‡ã€‚

ä¸ºæ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ [`torch.zeros_like(input)`](https://pytorch.org/docs/stable/generated/torch.zeros_like.html) æˆ–è€… [`torch.ones_like(input)`](https://pytorch.org/docs/1.9.1/generated/torch.ones_like.html)ï¼Œå®ƒä»¬åˆ†åˆ«è¿”å›ä¸€ä¸ªä¸ `input` å½¢çŠ¶ç›¸åŒä½†å¡«å……äº†é›¶æˆ–ä¸€çš„å¼ é‡ã€‚

ä½¿ç”¨ `torch.zeros_like(input)` å’Œ `torch.ones_like(input)` å‡½æ•°æ—¶ï¼Œä½ åªéœ€è¦æä¾›ä¸€ä¸ªå·²æœ‰çš„å¼ é‡ä½œä¸º `input` å‚æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å°±ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å¼ é‡ï¼Œå…¶å½¢çŠ¶ä¸è¾“å…¥å¼ é‡ç›¸åŒï¼Œä½†æ‰€æœ‰å…ƒç´ åˆ†åˆ«æ˜¯0æˆ–1ã€‚

```Python
ten_zeros = torch.zeros_like(input=zero_to_ten)
print(ten_zeors)
```
## 3.7 å¼ é‡æ•°æ®ç±»å‹

åœ¨PyTorchä¸­æœ‰è®¸å¤šä¸åŒçš„[å¼ é‡æ•°æ®ç±»å‹](https://pytorch.org/docs/stable/tensors.html#data-types)ã€‚

æœ‰äº›æ˜¯ç‰¹å®šäºCPUçš„ï¼Œæœ‰äº›åˆ™æ›´é€‚åˆGPUã€‚

äº†è§£å®ƒä»¬å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚

é€šå¸¸ï¼Œå¦‚æœä½ åœ¨ä»»ä½•åœ°æ–¹çœ‹åˆ° `torch.cuda`ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼ é‡æ˜¯ç”¨äºGPUçš„ï¼ˆå› ä¸ºNvidia GPUä½¿ç”¨ä¸€ä¸ªåä¸ºCUDAçš„è®¡ç®—å·¥å…·åŒ…ï¼‰ã€‚

æœ€å¸¸è§çš„ç±»å‹ï¼ˆé€šå¸¸ä¹Ÿæ˜¯é»˜è®¤ç±»å‹ï¼‰æ˜¯`torch.float32`æˆ–`torch.float`ã€‚

è¿™è¢«ç§°ä¸ºâ€œ32ä½æµ®ç‚¹æ•°â€ã€‚

ä½†ä¹Ÿæœ‰16ä½æµ®ç‚¹æ•°ï¼ˆ`torch.float16` æˆ– `torch.half`ï¼‰å’Œ64ä½æµ®ç‚¹æ•°ï¼ˆ`torch.float64` æˆ– `torch.double`ï¼‰ã€‚

è¿˜æœ‰8ä½ã€16ä½ã€32ä½å’Œ64ä½æ•´æ•°ã€‚

è¿˜æœ‰æ›´å¤šï¼

> **æ³¨æ„ï¼š** æ•´æ•°æ˜¯ä¸€ä¸ªå¹³å¦çš„åœ†å½¢æ•°å­—ï¼Œå¦‚ `7`ï¼Œè€Œæµ®ç‚¹æ•°æœ‰ä¸€ä¸ªå°æ•° `7.0`ã€‚

æ‰€æœ‰è¿™äº›çš„åŸå› ä¸**è®¡ç®—ä¸­çš„ç²¾åº¦**æœ‰å…³ã€‚

ç²¾åº¦æ˜¯ç”¨æ¥æè¿°ä¸€ä¸ªæ•°å­—çš„ç»†èŠ‚é‡ã€‚

ç²¾åº¦å€¼è¶Šé«˜ï¼ˆ8ã€16ã€32ï¼‰ï¼Œç”¨æ¥è¡¨è¾¾ä¸€ä¸ªæ•°å­—çš„ç»†èŠ‚å’Œæ•°æ®å°±è¶Šå¤šã€‚

è¿™åœ¨æ·±åº¦å­¦ä¹ å’Œæ•°å€¼è®¡ç®—ä¸­å¾ˆé‡è¦ï¼Œå› ä¸ºä½ æ­£åœ¨è¿›è¡Œå¦‚æ­¤å¤šçš„æ“ä½œï¼Œä½ æ‹¥æœ‰çš„ç»†èŠ‚è¶Šå¤šï¼Œä½ å°±éœ€è¦ä½¿ç”¨æ›´å¤šçš„è®¡ç®—èµ„æºã€‚

å› æ­¤ï¼Œä½ç²¾åº¦æ•°æ®ç±»å‹é€šå¸¸è®¡ç®—é€Ÿåº¦æ›´å¿«ï¼Œä½†åœ¨è¯„ä¼°æŒ‡æ ‡å¦‚å‡†ç¡®æ€§ä¸Šä¼šç‰ºç‰²ä¸€äº›æ€§èƒ½ï¼ˆè®¡ç®—é€Ÿåº¦æ›´å¿«ä½†å‡†ç¡®æ€§è¾ƒä½ï¼‰ã€‚

> **èµ„æºï¼š**
  * è¯·å‚é˜…[PyTorchæ–‡æ¡£](https://pytorch.org/docs/stable/tensors.html#data-types)ï¼Œäº†è§£æ‰€æœ‰å¯ç”¨å¼ é‡æ•°æ®ç±»å‹çš„åˆ—è¡¨ã€‚
  * é˜…è¯»[ç»´åŸºç™¾ç§‘é¡µé¢](https://en.wikipedia.org/wiki/Precision_(computer_science))ï¼Œäº†è§£è®¡ç®—ä¸­ç²¾åº¦çš„æ¦‚è¿°ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ›å»ºå…·æœ‰ç‰¹å®šæ•°æ®ç±»å‹çš„å¼ é‡ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`dtype`å‚æ•°æ¥å®ç°ã€‚

```Python
float_32_tensor = torch.tensor([3.0, 6.0, 9.0],
                               dtype=None, 
                               device=None, 
                               requires_grad=False)
print(float_32_tensor.shape)
print(float_32_tensor.dtype)
print(float_32_tensor.device)
```
é™¤äº†å½¢çŠ¶é—®é¢˜ï¼ˆå¼ é‡å½¢çŠ¶ä¸åŒ¹é…ï¼‰ä¹‹å¤–ï¼Œä½ åœ¨PyTorchä¸­é‡åˆ°çš„å¦å¤–ä¸¤ä¸ªæœ€å¸¸è§çš„é—®é¢˜å°±æ˜¯æ•°æ®ç±»å‹å’Œè®¾å¤‡é—®é¢˜ã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ªå¼ é‡æ˜¯`torch.float32`ï¼Œè€Œå¦ä¸€ä¸ªæ˜¯`torch.float16`ï¼ˆPyTorché€šå¸¸å¸Œæœ›å¼ é‡æ˜¯ç›¸åŒçš„æ ¼å¼ï¼‰ã€‚

æˆ–è€…ä½ çš„ä¸€ä¸ªå¼ é‡åœ¨CPUä¸Šï¼Œè€Œå¦ä¸€ä¸ªåœ¨GPUä¸Šï¼ˆPyTorchå¸Œæœ›å¼ é‡ä¹‹é—´çš„è®¡ç®—åœ¨åŒä¸€è®¾å¤‡ä¸Šè¿›è¡Œï¼‰ã€‚

æˆ‘ä»¬ç¨åä¼šæ›´å¤šåœ°è®¨è®ºè®¾å¤‡é—®é¢˜ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`dtype=torch.float16`çš„æ•°æ®ç±»å‹çš„å¼ é‡ã€‚

``` Python
float_16_tensor = torch.tensor([3.0, 6.0, 9.0],
                               dtype=torch.float16)

float_16_tensor.dtype
```
## 3.8 ä»å¼ é‡ä¸­è·å–ä¿¡æ¯
ä¸€æ—¦ä½ åˆ›å»ºäº†å¼ é‡ï¼ˆæˆ–è€…åˆ«äººä¸ºä½ åˆ›å»ºäº†å¼ é‡ï¼Œæˆ–è€…PyTorchæ¨¡å—ä¸ºä½ åˆ›å»ºäº†å®ƒä»¬ï¼‰ï¼Œä½ å¯èƒ½æƒ³è¦ä»å®ƒä»¬é‚£é‡Œè·å–ä¸€äº›ä¿¡æ¯ã€‚

æˆ‘ä»¬å·²ç»è§è¿‡è¿™äº›ï¼Œä½†æ˜¯å…³äºå¼ é‡ï¼Œä½ æœ€æƒ³äº†è§£çš„ä¸‰ä¸ªæœ€å¸¸è§çš„å±æ€§æ˜¯ï¼š
* `shape` - å¼ é‡çš„å½¢çŠ¶æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸€äº›æ“ä½œéœ€è¦ç‰¹å®šçš„å½¢çŠ¶è§„åˆ™ï¼‰
* `dtype` - å¼ é‡å†…éƒ¨çš„å…ƒç´ å­˜å‚¨çš„æ•°æ®ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ
* `device` - å¼ é‡å­˜å‚¨åœ¨å“ªä¸ªè®¾å¤‡ä¸Šï¼Ÿï¼ˆé€šå¸¸æ˜¯GPUæˆ–CPUï¼‰

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéšæœºå¼ é‡ï¼Œå¹¶æ‰¾å‡ºæœ‰å…³å®ƒçš„è¯¦ç»†ä¿¡æ¯ã€‚

```Python
# Create a tensor
some_tensor = torch.rand(3, 4)

# Find out details about it
print(some_tensor)
print(f"å¼ é‡çš„ shape : {some_tensor.shape}")
print(f"å¼ é‡çš„ç±»å‹ : {some_tensor.dtype}")
print(f"å¼ é‡å­˜å‚¨çš„ä½ç½® : {some_tensor.device}")
```
> **æ³¨æ„ï¼š** å½“ä½ åœ¨PyTorchä¸­é‡åˆ°é—®é¢˜æ—¶ï¼Œè¿™é€šå¸¸ä¸ä¸Šè¿°ä¸‰ä¸ªå±æ€§ä¸­çš„ä¸€ä¸ªæœ‰å…³ã€‚

## 3.9 å¼ é‡è¿ç®—
åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ•°æ®ï¼ˆå›¾åƒã€æ–‡æœ¬ã€è§†é¢‘ã€éŸ³é¢‘ã€è›‹ç™½è´¨ç»“æ„ç­‰ï¼‰è¢«è¡¨ç¤ºä¸ºå¼ é‡ã€‚

æ¨¡å‹é€šè¿‡ç ”ç©¶è¿™äº›å¼ é‡å¹¶åœ¨å¼ é‡ä¸Šæ‰§è¡Œä¸€ç³»åˆ—æ“ä½œï¼ˆå¯èƒ½æ˜¯100ä¸‡æ¬¡ä»¥ä¸Šï¼‰æ¥åˆ›å»ºè¾“å…¥æ•°æ®ä¸­æ¨¡å¼çš„è¡¨ç¤ºã€‚

è¿™äº›æ“ä½œé€šå¸¸æ˜¯åœ¨ä»¥ä¸‹å‡ é¡¹ä¹‹é—´è¿›è¡Œçš„ï¼š
* åŠ æ³•
* å‡æ³•
* ä¹˜æ³•ï¼ˆé€å…ƒç´ ï¼‰
* é™¤æ³•
* çŸ©é˜µä¹˜æ³•

ä»…æ­¤è€Œå·²ã€‚å½“ç„¶ï¼Œè¿™é‡Œå’Œé‚£é‡Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ“ä½œï¼Œä½†è¿™äº›æ˜¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ„å»ºå—ã€‚

ä»¥æ­£ç¡®çš„æ–¹å¼å †å è¿™äº›æ„å»ºå—ï¼Œä½ å¯ä»¥åˆ›å»ºæœ€å¤æ‚çš„ç¥ç»ç½‘ç»œï¼ˆå°±åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼ï¼‰ã€‚

### 3.9.1 åŸºæœ¬æ“ä½œ

è®©æˆ‘ä»¬ä»å‡ ä¸ªåŸºæœ¬æ“ä½œå¼€å§‹ï¼ŒåŠ æ³•ï¼ˆ`+`ï¼‰ã€å‡æ³•ï¼ˆ`-`ï¼‰ã€ä¹˜æ³•ï¼ˆ`*`ï¼‰ã€‚

å®ƒä»¬çš„å·¥ä½œæ–¹å¼æ­£å¦‚ä½ æ‰€æƒ³è±¡çš„é‚£æ ·ã€‚
```Python
tensor = torch.tensor([1, 2, 3])
print(tensor + 10)
print(tensor * 10)
```

æ³¨æ„åˆ°ä¸Šé¢çš„å¼ é‡å€¼æœ€ç»ˆå¹¶æ²¡æœ‰å˜æˆ `tensor([110, 120, 130])`ï¼Œè¿™æ˜¯å› ä¸ºå¼ é‡å†…éƒ¨çš„å€¼é™¤éè¢«é‡æ–°èµ‹å€¼ï¼Œå¦åˆ™ä¸ä¼šæ”¹å˜ã€‚

```Python
print(tensor)
```
å¥½çš„ï¼Œè®©æˆ‘ä»¬ä»ä¸€ä¸ªæ•°å­—ä¸­å‡å»ï¼Œå¹¶è¿™æ¬¡æˆ‘ä»¬å°†é‡æ–°èµ‹å€¼ç»™ tensor å˜é‡ã€‚
```Python
tensor = tensor - 10
print(tensor)
```
```Python
tensor = tensor + 10
print(tensor)
```

PyTorchè¿˜æä¾›äº†è®¸å¤šå†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚ [`torch.mul()`](https://pytorch.org/docs/stable/generated/torch.mul.html#torch.mul)ï¼ˆä¹˜æ³•çš„ç®€ç§°ï¼‰å’Œ [`torch.add()`](https://pytorch.org/docs/stable/generated/torch.add.html)ï¼Œç”¨äºæ‰§è¡ŒåŸºæœ¬æ“ä½œã€‚

è¿™äº›å†…ç½®å‡½æ•°æä¾›äº†ä¸€ç§ä¸ä½¿ç”¨Pythonè¿ç®—ç¬¦ï¼ˆå¦‚ `*` å’Œ `+` ï¼‰è€Œæ˜¯ä½¿ç”¨PyTorchå‡½æ•°çš„æ–¹å¼æ¥æ‰§è¡Œå¼ é‡è¿ç®—ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å½“éœ€è¦æ˜ç¡®æŒ‡å®šæ“ä½œçš„ç»´åº¦æˆ–è€…å½“éœ€è¦ä¿æŒæ“ä½œçš„æ¢¯åº¦ä¿¡æ¯æ—¶ã€‚

```Python
print(torch.multiply(tensor, 10))

print(tensor)
```

ç„¶è€Œï¼Œæ›´å¸¸è§çš„æ˜¯ä½¿ç”¨æ“ä½œç¬¦ç¬¦å·ï¼Œå¦‚ `*`ï¼Œè€Œä¸æ˜¯ `torch.mul()`ã€‚

```Python
print(tensor, "*", tensor)
print("Equals:", tensor * tensor)
```
### 3.9.2 çŸ©é˜µä¹˜æ³•

åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ç®—æ³•ï¼ˆå¦‚ç¥ç»ç½‘ç»œï¼‰ä¸­æœ€å¸¸ç”¨çš„æ“ä½œä¹‹ä¸€æ˜¯[çŸ©é˜µä¹˜æ³•](https://www.mathsisfun.com/algebra/matrix-multiplying.html)ã€‚

PyTorchåœ¨[`torch.matmul()`](https://pytorch.org/docs/stable/generated/torch.matmul.html)æ–¹æ³•ä¸­å®ç°äº†çŸ©é˜µä¹˜æ³•åŠŸèƒ½ã€‚

éœ€è¦è®°ä½çš„çŸ©é˜µä¹˜æ³•çš„ä¸¤ä¸ªä¸»è¦è§„åˆ™æ˜¯ï¼š

1. **å†…ç»´åº¦**å¿…é¡»åŒ¹é…ï¼š
  * `(3, 2) @ (3, 2)` ä¸å¯è¡Œ
  * `(2, 3) @ (3, 2)` å¯è¡Œ
  * `(3, 2) @ (2, 3)` å¯è¡Œ
2. ç»“æœçŸ©é˜µçš„å½¢çŠ¶æ˜¯**å¤–ç»´åº¦**çš„å½¢çŠ¶ï¼š
 * `(2, 3) @ (3, 2)` -> `(2, 2)`
 * `(3, 2) @ (2, 3)` -> `(3, 3)`

> **æ³¨æ„ï¼š** åœ¨Pythonä¸­ï¼Œ"`@`"æ˜¯çŸ©é˜µä¹˜æ³•çš„ç¬¦å·ã€‚

> **èµ„æºï¼š** ä½ å¯ä»¥åœ¨[PyTorchæ–‡æ¡£](https://pytorch.org/docs/stable/generated/torch.matmul.html)ä¸­æŸ¥çœ‹ä½¿ç”¨`torch.matmul()`è¿›è¡ŒçŸ©é˜µä¹˜æ³•çš„æ‰€æœ‰è§„åˆ™ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¼ é‡ï¼Œå¹¶åœ¨å…¶ä¸Šæ‰§è¡Œé€å…ƒç´ ä¹˜æ³•å’ŒçŸ©é˜µä¹˜æ³•ã€‚

```Python
import torch
tensor = torch.tensor([1, 2, 3])
print(tensor.shape)
```
é€å…ƒç´ ä¹˜æ³•å’ŒçŸ©é˜µä¹˜æ³•ä¹‹é—´çš„å·®å¼‚åœ¨äºå€¼çš„ç›¸åŠ æ–¹å¼ã€‚

å¯¹äºæˆ‘ä»¬çš„ `tensor` å˜é‡ï¼Œå…¶å€¼ä¸º `[1, 2, 3]`ï¼š

| æ“ä½œ | è®¡ç®— | ä»£ç  |
| ----- | ----- | ----- |
| **é€å…ƒç´ ä¹˜æ³•** | `[1*1, 2*2, 3*3]` = `[1, 4, 9]` | `tensor * tensor` |
| **çŸ©é˜µä¹˜æ³•** | `[1*1 + 2*2 + 3*3]` = `[14]` | `tensor.matmul(tensor)` |

```Python
print(tensor * tensor)

print(torch.matmul(tensor, tensor))

print(tensor @ tensor)
```

ä½ å¯ä»¥æ‰‹å·¥è¿›è¡ŒçŸ©é˜µä¹˜æ³•ï¼Œä½†ä¸å»ºè®®è¿™æ ·åšã€‚

å†…ç½®çš„ `torch.matmul()` æ–¹æ³•æ›´å¿«ã€‚

```Python
%%time
# æ‰‹åŠ¨è®¡ç®— be likeï¼š
value = 0
for i in range(len(tensor)):
  value += tensor[i] * tensor[i]
print(value)
```
```Python
%%time
# ç”¨å‡½æ•°è®¡ç®— be likeï¼š
torch.matmul(tensor, tensor)
```
### 3.9.3 æ·±åº¦å­¦ä¹ ä¸­æœ€å¸¸è§é”™è¯¯ä¹‹ä¸€ï¼ˆå½¢çŠ¶é”™è¯¯ï¼‰

ç”±äºæ·±åº¦å­¦ä¹ çš„å¤§éƒ¨åˆ†å†…å®¹æ¶‰åŠçŸ©é˜µçš„ä¹˜æ³•å’Œæ“ä½œï¼Œè€ŒçŸ©é˜µå¯¹äºå½¢çŠ¶å’Œå¤§å°çš„ç»„åˆæœ‰ä¸¥æ ¼çš„è§„åˆ™ï¼Œå› æ­¤ä½ åœ¨æ·±åº¦å­¦ä¹ ä¸­æœ€å¸¸è§çš„é”™è¯¯ä¹‹ä¸€å°±æ˜¯å½¢çŠ¶ä¸åŒ¹é…ã€‚
```Python
# ä¸‹é¢è¿™ä¸ªä»£ç ä¼šæŠ¥é”™
tensor_A = torch.tensor([[1, 2],
                         [3, 4],
                         [5, 6]], dtype=torch.float32)

tensor_B = torch.tensor([[7, 10],
                         [8, 11], 
                         [9, 12]], dtype=torch.float32)

torch.matmul(tensor_A, tensor_B) # (this will error)
```
æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ `tensor_A` å’Œ `tensor_B` çš„å†…ç»´åº¦åŒ¹é…æ¥å®ç°å®ƒä»¬ä¹‹é—´çš„çŸ©é˜µä¹˜æ³•ã€‚

å®ç°è¿™ä¸€ç‚¹çš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿ç”¨**è½¬ç½®**ï¼ˆäº¤æ¢ç»™å®šå¼ é‡çš„ç»´åº¦ï¼‰ã€‚

ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»»ä¸€æ–¹æ³•åœ¨PyTorchä¸­æ‰§è¡Œè½¬ç½®ï¼š
* `torch.transpose(input, dim0, dim1)` - å…¶ä¸­ `input` æ˜¯è¦è½¬ç½®çš„å¼ é‡ï¼Œ`dim0` å’Œ `dim1` æ˜¯è¦äº¤æ¢çš„ç»´åº¦ã€‚
* `tensor.T` - å…¶ä¸­ `tensor` æ˜¯è¦è½¬ç½®çš„å¼ é‡ã€‚

æˆ‘ä»¬æ¥å°è¯•åè€…ã€‚
```Python
print(tensor_A)
print(tensor_B)
```
```Python
print(tensor_A)
print(tensor_B.T)
```
```Python
print(f"Original shapes: tensor_A = {tensor_A.shape}, tensor_B = {tensor_B.shape}\n")
print(f"New shapes: tensor_A = {tensor_A.shape} (same as above), tensor_B.T = {tensor_B.T.shape}\n")
print(f"Multiplying: {tensor_A.shape} * {tensor_B.T.shape} <- inner dimensions match\n")
print("Output:\n")
output = torch.matmul(tensor_A, tensor_B.T)
print(output) 
print(f"\nOutput shape: {output.shape}")
```

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ [`torch.mm()`](https://pytorch.org/docs/stable/generated/torch.mm.html)ï¼Œå®ƒæ˜¯ `torch.matmul()` çš„ç®€ç§°ã€‚

`torch.mm()` æ˜¯ä¸€ä¸ªç”¨äºçŸ©é˜µä¹˜æ³•çš„ä¾¿æ·å‡½æ•°ï¼Œå®ƒæ˜¯ `torch.matmul()` çš„åˆ«åï¼Œä¸“é—¨ç”¨äºçŸ©é˜µä¹˜æ³•æ“ä½œã€‚è¿™ä¸ªå‡½æ•°é€‚ç”¨äºä¸¤ä¸ªäºŒç»´å¼ é‡çš„ä¹˜æ³•ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå¼ é‡çš„åˆ—æ•°å¿…é¡»ä¸ç¬¬äºŒä¸ªå¼ é‡çš„è¡Œæ•°ç›¸åŒ¹é…ã€‚ç»“æœå¼ é‡å°†å…·æœ‰ä¸ç¬¬ä¸€ä¸ªå¼ é‡ç›¸åŒçš„è¡Œæ•°å’Œä¸ç¬¬äºŒä¸ªå¼ é‡ç›¸åŒçš„åˆ—æ•°ã€‚
```Python
print(torch.mm(tensor_A, tensor_B.T))
```
### 3.9.4 ç¥ç»ç½‘ç»œä¸­çš„çŸ©é˜µè¿ç®—
ç¥ç»ç½‘ç»œä¸­å……æ»¡äº†çŸ©é˜µä¹˜æ³•å’Œç‚¹ç§¯ã€‚

[`torch.nn.Linear()`](https://pytorch.org/docs/1.9.1/generated/torch.nn.Linear.html) æ¨¡å—ï¼ˆæˆ‘ä»¬ç¨åå°†å®é™…çœ‹åˆ°å®ƒçš„åº”ç”¨ï¼‰ï¼Œä¹Ÿç§°ä¸ºå‰é¦ˆå±‚æˆ–å…¨è¿æ¥å±‚ï¼Œå®ç°äº†è¾“å…¥ `x` å’Œæƒé‡çŸ©é˜µ `A` ä¹‹é—´çš„çŸ©é˜µä¹˜æ³•ã€‚

$$ y = x\cdot A^T + b $$

å…¶ä¸­ï¼š
* `x` æ˜¯è¯¥å±‚çš„è¾“å…¥ï¼ˆæ·±åº¦å­¦ä¹ æ˜¯åƒ `torch.nn.Linear()` è¿™æ ·çš„å±‚å †å åœ¨ä¸€èµ·ï¼‰ã€‚
* `A` æ˜¯ç”±è¯¥å±‚åˆ›å»ºçš„æƒé‡çŸ©é˜µï¼Œè¿™æœ€åˆæ˜¯éšæœºæ•°ï¼Œéšç€ç¥ç»ç½‘ç»œå­¦ä¹ ä»¥æ›´å¥½åœ°è¡¨ç¤ºæ•°æ®ä¸­çš„æ¨¡å¼è€Œè¿›è¡Œè°ƒæ•´ï¼ˆæ³¨æ„ "`T`"ï¼Œè¿™æ˜¯å› ä¸ºæƒé‡çŸ©é˜µéœ€è¦è½¬ç½®ï¼‰ã€‚
  * **æ³¨æ„ï¼š** ä½ å¯èƒ½è¿˜ä¼šç»å¸¸çœ‹åˆ° `W` æˆ–å…¶ä»–å­—æ¯å¦‚ `X` ç”¨æ¥è¡¨ç¤ºæƒé‡çŸ©é˜µã€‚
* `b` æ˜¯åç½®é¡¹ï¼Œç”¨äºè½»å¾®åç§»æƒé‡å’Œè¾“å…¥ã€‚
* `y` æ˜¯è¾“å‡ºï¼ˆå¯¹è¾“å…¥çš„æ“çºµï¼Œå¸Œæœ›å‘ç°å…¶ä¸­çš„æ¨¡å¼ï¼‰ã€‚

è¿™æ˜¯ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼ˆä½ å¯èƒ½åœ¨é«˜ä¸­æˆ–å…¶ä»–åœºåˆè§è¿‡ç±»ä¼¼ $y = mx + b$ çš„ä¸œè¥¿ï¼‰ï¼Œå¯ä»¥ç”¨æ¥ç”»ä¸€æ¡ç›´çº¿ï¼

è®©æˆ‘ä»¬æ¥ç©è½¬ä¸€ä¸‹çº¿æ€§å±‚ã€‚

å°è¯•æ”¹å˜ä¸‹é¢çš„ `in_features` å’Œ `out_features` çš„å€¼ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°ä¸å½¢çŠ¶æœ‰å…³çš„ä»»ä½•äº‹æƒ…ï¼Ÿ
```Python
# Since the linear layer starts with a random weights matrix, let's make it reproducible (more on this later)
print(torch.manual_seed(42))
# This uses matrix multiplication
linear = torch.nn.Linear(in_features=2, # in_features = matches inner dimension of input 
                         out_features=6) # out_features = describes outer value 
print(x = tensor_A)
output = linear(x)
print(f"Input shape: {x.shape}\n")
print(f"Output:\n{output}\n\nOutput shape: {output.shape}")
```
> **é—®é¢˜ï¼š** å¦‚æœä½ å°†ä¸Šé¢çš„ `in_features` ä» 2 æ”¹ä¸º 3 ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¼šå‡ºç°é”™è¯¯å—ï¼Ÿä½ å¦‚ä½•æ”¹å˜è¾“å…¥ï¼ˆ`x`ï¼‰çš„å½¢çŠ¶ä»¥é€‚åº”è¿™ä¸ªé”™è¯¯ï¼Ÿæç¤ºï¼šæˆ‘ä»¬ä¹‹å‰å¯¹ `tensor_B` åšäº†ä»€ä¹ˆï¼Ÿ

### 3.9.5 å¯»æ‰¾æœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ã€æ€»å’Œç­‰ï¼ˆèšåˆï¼‰

ç°åœ¨æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä¸€äº›æ“ä½œå¼ é‡çš„æ–¹æ³•ï¼Œè®©æˆ‘ä»¬æ¥äº†è§£ä¸€äº›èšåˆå®ƒä»¬çš„æ–¹æ³•ï¼ˆä»å¤šä¸ªå€¼å˜ä¸ºè¾ƒå°‘çš„å€¼ï¼‰ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¼ é‡ï¼Œç„¶åæ‰¾åˆ°å®ƒçš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼å’Œæ€»å’Œã€‚
```Python
x = torch.arange(0, 100, 10)
print(x)

print(f"Minimum: {x.min()}")
print(f"Maximum: {x.max()}")
# print(f"Mean: {x.mean()}") # this will error
print(f"Mean: {x.type(torch.float32).mean()}") # won't work without float datatype
print(f"Sum: {x.sum()}")
```

> **æ³¨æ„ï¼š** ä½ å¯èƒ½ä¼šå‘ç°ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚ `torch.mean()`ï¼Œè¦æ±‚å¼ é‡å¿…é¡»æ˜¯ `torch.float32`ï¼ˆæœ€å¸¸è§çš„ï¼‰æˆ–å¦ä¸€ç§ç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œå¦åˆ™æ“ä½œå°†å¤±è´¥ã€‚

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ `torch` æ–¹æ³•æ¥æ‰§è¡Œä¸Šè¿°ç›¸åŒçš„æ“ä½œã€‚
### 3.9.6 ä½ç½®æœ€å°å€¼/æœ€å¤§å€¼

ä½ è¿˜å¯ä»¥åˆ†åˆ«ä½¿ç”¨ [`torch.argmax()`](https://pytorch.org/docs/stable/generated/torch.argmax.html) å’Œ [`torch.argmin()`](https://pytorch.org/docs/stable/generated/torch.argmin.html) æ¥æ‰¾åˆ°å¼ é‡ä¸­æœ€å¤§å€¼æˆ–æœ€å°å€¼å‡ºç°çš„ä½ç½®ç´¢å¼•ã€‚

è¿™åœ¨ä½ åªæƒ³è¦æœ€é«˜ï¼ˆæˆ–æœ€ä½ï¼‰å€¼çš„ä½ç½®è€Œä¸æ˜¯å®é™…å€¼æœ¬èº«æ—¶éå¸¸æœ‰ç”¨ï¼ˆæˆ‘ä»¬å°†åœ¨ç¨åä½¿ç”¨[softmaxæ¿€æ´»å‡½æ•°](https://pytorch.org/docs/stable/generated/torch.nn.Softmax.html)çš„ç« èŠ‚ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ï¼‰ã€‚

```Python
# Create a tensor
tensor = torch.arange(10, 100, 10)
print(f"Tensor: {tensor}")

# Returns index of max and min values
print(f"Index where max value occurs: {tensor.argmax()}")
print(f"Index where min value occurs: {tensor.argmin()}")
```

### 3.9.7 æ”¹å˜å¼ é‡æ•°æ®ç±»å‹

æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œæ·±åº¦å­¦ä¹ æ“ä½œä¸­ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯å¼ é‡çš„æ•°æ®ç±»å‹ä¸åŒã€‚

å¦‚æœä¸€ä¸ªå¼ é‡æ˜¯ `torch.float64` è€Œå¦ä¸€ä¸ªæ˜¯ `torch.float32`ï¼Œä½ å¯èƒ½ä¼šç¢°åˆ°ä¸€äº›é”™è¯¯ã€‚

ä½†æ˜¯æœ‰ä¸€ä¸ªè§£å†³åŠæ³•ã€‚

ä½ å¯ä»¥ä½¿ç”¨ [`torch.Tensor.type(dtype=None)`](https://pytorch.org/docs/stable/generated/torch.Tensor.type.html) æ¥æ”¹å˜å¼ é‡çš„æ•°æ®ç±»å‹ï¼Œå…¶ä¸­ `dtype` å‚æ•°æ˜¯ä½ æƒ³è¦ä½¿ç”¨çš„æ•°æ®ç±»å‹ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¼ é‡å¹¶æ£€æŸ¥å…¶æ•°æ®ç±»å‹ï¼ˆé»˜è®¤æ˜¯ `torch.float32`ï¼‰ã€‚
```Python
# Create a tensor and check its datatype
tensor = torch.arange(10., 100., 10.)
print(tensor.dtype)
```
ç°åœ¨æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä¸ä¹‹å‰ç›¸åŒçš„å¼ é‡ï¼Œä½†æ˜¯å°†å…¶æ•°æ®ç±»å‹æ›´æ”¹ä¸º `torch.float16`ã€‚
```Python
tensor_float16 = tensor.type(torch.float16)
print(tensor_float16)
```
æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›è¡Œç±»ä¼¼çš„æ“ä½œæ¥åˆ›å»ºä¸€ä¸ª `torch.int8` ç±»å‹çš„å¼ é‡ã€‚
```Python
tensor_int8 = tensor.type(torch.int8)
print(tensor_int8)
```
> **æ³¨æ„ï¼š** ä¸åŒçš„æ•°æ®ç±»å‹ä¸€å¼€å§‹å¯èƒ½ä¼šè®©äººæ„Ÿåˆ°å›°æƒ‘ã€‚ä½†å¯ä»¥è¿™æ ·ç†è§£ï¼Œæ•°å­—è¶Šå°ï¼ˆä¾‹å¦‚32ã€16ã€8ï¼‰ï¼Œè®¡ç®—æœºå­˜å‚¨è¯¥å€¼çš„ç²¾åº¦å°±è¶Šä½ã€‚å­˜å‚¨é‡è¶Šå°‘ï¼Œé€šå¸¸æ„å‘³ç€æ›´å¿«çš„è®¡ç®—é€Ÿåº¦å’Œæ›´å°çš„æ¨¡å‹æ€»ä½“å¤§å°ã€‚åŸºäºç§»åŠ¨è®¾å¤‡çš„ç¥ç»ç½‘ç»œé€šå¸¸ä½¿ç”¨8ä½æ•´æ•°è¿›è¡Œæ“ä½œï¼Œå®ƒä»¬æ¯”float32çš„å¯¹åº”ç‰©æ›´å°ã€è¿è¡Œæ›´å¿«ï¼Œä½†å‡†ç¡®åº¦è¾ƒä½ã€‚æƒ³è¦äº†è§£æ›´å¤šï¼Œå¯ä»¥é˜…è¯»å…³äº[è®¡ç®—ä¸­çš„ç²¾åº¦](https://en.wikipedia.org/wiki/Precision_(computer_science))çš„å†…å®¹ã€‚

> **ç»ƒä¹ ï¼š** åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†ä¸€äº›å¼ é‡æ–¹æ³•ï¼Œä½†åœ¨ [`torch.Tensor` æ–‡æ¡£](https://pytorch.org/docs/stable/tensors.html) ä¸­è¿˜æœ‰æ›´å¤šã€‚æˆ‘å»ºè®®ä½ èŠ±10åˆ†é’Ÿæµè§ˆä¸€ä¸‹ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¼•èµ·ä½ æ³¨æ„çš„æ–¹æ³•ã€‚ç‚¹å‡»å®ƒä»¬ï¼Œç„¶ååœ¨ä»£ç ä¸­è‡ªå·±å°è¯•ç¼–å†™è¿™äº›æ–¹æ³•ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

### 3.9.8 é‡å¡‘ã€å †å ã€å‹ç¼©å’Œå–æ¶ˆå‹ç¼©

å¾ˆå¤šæ—¶å€™ï¼Œä½ å¯èƒ½æƒ³è¦é‡å¡‘æˆ–æ”¹å˜ä½ çš„å¼ é‡çš„ç»´åº¦ï¼Œè€Œå®é™…ä¸Šå¹¶ä¸æ”¹å˜å®ƒä»¬å†…éƒ¨çš„å€¼ã€‚

ä¸ºæ­¤ï¼Œä¸€äº›å¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š

| æ–¹æ³• | ä¸€å¥è¯æè¿° |
| ----- | ----- |
| [`torch.reshape(input, shape)`](https://pytorch.org/docs/stable/generated/torch.reshape.html#torch.reshape) | å°† `input` é‡å¡‘ä¸º `shape`ï¼ˆå¦‚æœå…¼å®¹ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `torch.Tensor.reshape()`ã€‚ |
| [`Tensor.view(shape)`](https://pytorch.org/docs/stable/generated/torch.Tensor.view.html) | è¿”å›åŸå§‹å¼ é‡çš„ä¸€ä¸ªè§†å›¾ï¼Œå…¶å½¢çŠ¶ä¸åŒ `shape`ï¼Œä½†ä¸åŸå§‹å¼ é‡å…±äº«ç›¸åŒçš„æ•°æ®ã€‚ |
| [`torch.stack(tensors, dim=0)`](https://pytorch.org/docs/1.9.1/generated/torch.stack.html) | æ²¿ç€ä¸€ä¸ªæ–°çš„ç»´åº¦ï¼ˆ`dim`ï¼‰è¿æ¥ä¸€ç³»åˆ— `tensors`ï¼Œæ‰€æœ‰çš„ `tensors` å¿…é¡»å¤§å°ç›¸åŒã€‚ |
| [`torch.squeeze(input)`](https://pytorch.org/docs/stable/generated/torch.squeeze.html) | å‹ç¼© `input` ä»¥ç§»é™¤æ‰€æœ‰å€¼ä¸º `1` çš„ç»´åº¦ã€‚ |
| [`torch.unsqueeze(input, dim)`](https://pytorch.org/docs/1.9.1/generated/torch.unsqueeze.html) | è¿”å› `input`ï¼Œå¹¶åœ¨ `dim` å¤„æ·»åŠ ä¸€ä¸ªå€¼ä¸º `1` çš„ç»´åº¦ã€‚ |
| [`torch.permute(input, dims)`](https://pytorch.org/docs/stable/generated/torch.permute.html) | è¿”å›åŸå§‹ `input` çš„ä¸€ä¸ªè§†å›¾ï¼Œå…¶ç»´åº¦è¢«ç½®æ¢ï¼ˆé‡æ–°æ’åˆ—ï¼‰ä¸º `dims`ã€‚ |

ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Ÿ

å› ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆç¥ç»ç½‘ç»œï¼‰éƒ½æ˜¯ä»¥æŸç§æ–¹å¼æ“ä½œå¼ é‡ã€‚ç”±äºçŸ©é˜µä¹˜æ³•çš„è§„åˆ™ï¼Œå¦‚æœä½ æœ‰å½¢çŠ¶ä¸åŒ¹é…çš„é—®é¢˜ï¼Œä½ ä¼šé‡åˆ°é”™è¯¯ã€‚è¿™äº›æ–¹æ³•å¸®åŠ©ä½ ç¡®ä¿ä½ çš„å¼ é‡çš„æ­£ç¡®çš„å…ƒç´ ä¸å…¶ä»–å¼ é‡çš„æ­£ç¡®çš„å…ƒç´ æ··åˆã€‚

è®©æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹å®ƒä»¬ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¼ é‡ã€‚

```Python
import torch
x = torch.arange(1., 8.)
print(x)
print(x.shape)
```

```Python
# Add an extra dimension
x_reshaped = x.reshape(1, 7)
print(x_reshaped)
print(x_reshaped.shape)
```

```Python
# Change view (keeps same data as original but changes view)
# See more: https://stackoverflow.com/a/54507446/7900723
z = x.view(1, 7)
print(z)
print(z.shape)
```

è¯·è®°ä½ï¼Œä½¿ç”¨ `torch.view()` æ”¹å˜å¼ é‡çš„è§†å›¾å®é™…ä¸Šåªåˆ›å»ºäº†åŒä¸€ä¸ªå¼ é‡çš„*æ–°è§†å›¾*ã€‚

æ‰€ä»¥æ”¹å˜è§†å›¾ä¹Ÿä¼šæ”¹å˜åŸå§‹å¼ é‡ã€‚

```Python
z[:, 0] = 5
print(z)
print(x)
```

```Python
# Stack tensors on top of each other
x_stacked = torch.stack([x, x, x, x], dim=0) # try changing dim to dim=1 and see what happens
print(x_stacked)
```

é‚£ä¹ˆï¼Œå¦‚ä½•ä»å¼ é‡ä¸­ç§»é™¤æ‰€æœ‰å•ä¸€ç»´åº¦å‘¢ï¼Ÿ

ä¸ºæ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ `torch.squeeze()`ï¼ˆæˆ‘è®°ä½œ*æŒ¤å‹*å¼ é‡ï¼Œä½¿å…¶åªæœ‰å¤§äº1çš„ç»´åº¦ï¼‰ã€‚

```Python
print(f"Previous tensor: {x_reshaped}")
print(f"Previous shape: {x_reshaped.shape}")

# Remove extra dimension from x_reshaped
x_squeezed = x_reshaped.squeeze()
print(f"\nNew tensor: {x_squeezed}")
print(f"New shape: {x_squeezed.shape}")
```

è¦æ‰§è¡Œ `torch.squeeze()` çš„åå‘æ“ä½œï¼Œä½ å¯ä»¥ä½¿ç”¨ `torch.unsqueeze()` åœ¨ç‰¹å®šç´¢å¼•å¤„æ·»åŠ ä¸€ä¸ªå€¼ä¸º1çš„ç»´åº¦ã€‚

```Python
print(f"Previous tensor: {x_squeezed}")
print(f"Previous shape: {x_squeezed.shape}")

## Add an extra dimension with unsqueeze
x_unsqueezed = x_squeezed.unsqueeze(dim=0)
print(f"\nNew tensor: {x_unsqueezed}")
print(f"New shape: {x_unsqueezed.shape}")
```

ä½ è¿˜å¯ä»¥ä½¿ç”¨ `torch.permute(input, dims)` é‡æ–°æ’åˆ—è½´çš„é¡ºåºï¼Œå…¶ä¸­ `input` è¢«è½¬æ¢æˆå…·æœ‰æ–° `dims` çš„*è§†å›¾*ã€‚

```Python
# Create tensor with specific shape
x_original = torch.rand(size=(224, 224, 3))

# Permute the original tensor to rearrange the axis order
x_permuted = x_original.permute(2, 0, 1) # shifts axis 0->1, 1->2, 2->0

print(f"Previous shape: {x_original.shape}")
print(f"New shape: {x_permuted.shape}")
```

> **æ³¨æ„**ï¼šå› ä¸ºç½®æ¢è¿”å›çš„æ˜¯ä¸€ä¸ª*è§†å›¾*ï¼ˆä¸åŸå§‹æ•°æ®å…±äº«ç›¸åŒçš„æ•°æ®ï¼‰ï¼Œæ‰€ä»¥ç½®æ¢åçš„å¼ é‡ä¸­çš„å€¼å°†ä¸åŸå§‹å¼ é‡çš„å€¼ç›¸åŒï¼Œå¦‚æœä½ åœ¨è§†å›¾ä¸­æ”¹å˜å€¼ï¼ŒåŸå§‹å¼ é‡çš„å€¼ä¹Ÿä¼šæ”¹å˜ã€‚

## 3.10 ç´¢å¼•ï¼ˆä»å¼ é‡ä¸­é€‰æ‹©æ•°æ®ï¼‰

æœ‰æ—¶ä½ æƒ³è¦ä»å¼ é‡ä¸­é€‰æ‹©ç‰¹å®šçš„æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œä»…ç¬¬ä¸€åˆ—æˆ–ç¬¬äºŒè¡Œï¼‰ã€‚

ä¸ºæ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ç´¢å¼•ã€‚

å¦‚æœä½ æ›¾ç»åœ¨Pythonåˆ—è¡¨æˆ–NumPyæ•°ç»„ä¸Šè¿›è¡Œè¿‡ç´¢å¼•ï¼Œé‚£ä¹ˆåœ¨PyTorchä¸­å¯¹å¼ é‡è¿›è¡Œç´¢å¼•æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚

```Python
import torch
x = torch.arange(1, 10).reshape(1, 3, 3)
x, x.shape
```
ç´¢å¼•å€¼ä»å¤–ç»´åº¦åˆ°å†…ç»´åº¦ï¼ˆæ£€æŸ¥ä¸€ä¸‹æ–¹æ‹¬å·ï¼‰ã€‚
```Python
print(f"First square bracket:\n{x[0]}") 
print(f"Second square bracket: {x[0][0]}") 
print(f"Third square bracket: {x[0][0][0]}")
```

ä½ è¿˜å¯ä»¥ä½¿ç”¨ `:` æ¥æŒ‡å®šâ€œè¿™ä¸ªç»´åº¦çš„æ‰€æœ‰å€¼â€ï¼Œç„¶åä½¿ç”¨é€—å·ï¼ˆ`,`ï¼‰æ¥æ·»åŠ å¦ä¸€ä¸ªç»´åº¦ã€‚

```Python
print(x[:, 0])
print(x[:, :, 1])
print(x[:, 1, 1])
print(x[0, 0, :])
```

ç´¢å¼•ä¸€å¼€å§‹å¯èƒ½ä¼šç›¸å½“ä»¤äººå›°æƒ‘ï¼Œç‰¹åˆ«æ˜¯å¯¹äºè¾ƒå¤§çš„å¼ é‡ï¼ˆæˆ‘ä»ç„¶éœ€è¦å°è¯•å¤šæ¬¡ç´¢å¼•æ‰èƒ½æ­£ç¡®ï¼‰ã€‚ä½†é€šè¿‡ä¸€äº›ç»ƒä¹ ï¼Œå¹¶ä¸æ–­å°è¯•å¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–ï¼Œä½ å°†å¼€å§‹æŒæ¡å®ƒã€‚

## 3.11 PyTorch å¼ é‡ä¸ Numpy æ•°ç»„

ç”±äº NumPy æ˜¯ä¸€ä¸ªæµè¡Œçš„ Python æ•°å€¼è®¡ç®—åº“ï¼Œå› æ­¤ PyTorch å…·æœ‰ä¸å…¶è‰¯å¥½äº¤äº’çš„åŠŸèƒ½ã€‚

ä½ éœ€è¦ç”¨äº NumPy åˆ° PyTorchï¼ˆä»¥åŠè¿”å›ï¼‰çš„ä¸¤ç§ä¸»è¦æ–¹æ³•æ˜¯ï¼š
* [`torch.from_numpy(ndarray)`](https://pytorch.org/docs/stable/generated/torch.from_numpy.html) - NumPy æ•°ç»„ -> PyTorch å¼ é‡ã€‚
* [`torch.Tensor.numpy()`](https://pytorch.org/docs/stable/generated/torch.Tensor.numpy.html) - PyTorch å¼ é‡ -> NumPy æ•°ç»„ã€‚

è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹ã€‚
```Python
# NumPy array to tensor
import torch
import numpy as np
array = np.arange(1.0, 8.0)
tensor = torch.from_numpy(array)
print(array)
print(tensor)
```
> **æ³¨æ„**ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒNumPy æ•°ç»„æ˜¯ä½¿ç”¨æ•°æ®ç±»å‹ `float64` åˆ›å»ºçš„ï¼Œå¦‚æœå°†å…¶è½¬æ¢ä¸º PyTorch å¼ é‡ï¼Œå®ƒå°†ä¿ç•™ç›¸åŒçš„æ•°æ®ç±»å‹ï¼ˆå¦‚ä¸Šæ‰€ç¤ºï¼‰ã€‚
>
> ä½†æ˜¯ï¼Œè®¸å¤š PyTorch è®¡ç®—é»˜è®¤ä½¿ç”¨ `float32`ã€‚
>
> å› æ­¤ï¼Œå¦‚æœè¦å°† NumPy æ•°ç»„ (float64) -> PyTorch å¼ é‡ (float64) -> PyTorch å¼ é‡ (float32)ï¼Œå¯ä»¥ä½¿ç”¨ `tensor = torch.from_numpy(array).type(torch.float32)`ã€‚

å› ä¸ºæˆ‘ä»¬åœ¨ä¸Šé¢é‡æ–°åˆ†é…äº† `tensor`ï¼Œæ‰€ä»¥å¦‚æœæ›´æ”¹å¼ é‡ï¼Œæ•°ç»„å°†ä¿æŒä¸å˜ã€‚

```Python
# Change the array, keep the tensor
array = array + 1
array, tensor
```
å¦‚æœä½ æƒ³ä» PyTorch å¼ é‡è½¬æ¢ä¸º NumPy æ•°ç»„ï¼Œä½ å¯ä»¥è°ƒç”¨ `tensor.numpy()`ã€‚

```Python
# Tensor to NumPy array
tensor = torch.ones(7) # create a tensor of ones with dtype=float32
numpy_tensor = tensor.numpy() # will be dtype=float32 unless changed
tensor, numpy_tensor
```

ä¸ä¸Šè¿°ç›¸åŒçš„è§„åˆ™é€‚ç”¨ï¼Œå¦‚æœä½ æ”¹å˜åŸå§‹çš„â€œå¼ é‡â€ï¼Œæ–°çš„ `numpy_tensor` ä¿æŒä¸å˜ã€‚

```Python
# Change the tensor, keep the array the same
tensor = tensor + 1
tensor, numpy_tensor
```

# 4. å°¾å£°
> âš ï¸ä¸‹é¢å†…å®¹ä¸ºä¸ªäººæ¨èï¼Œå…·ä½“æƒ…å†µè§†è‡ªèº«è€Œå®š
## 4.1 ç†è®ºè¯¾ç¨‹æ¨è
å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨‹ï¼š BV1FT4y1E74Vï¼ˆBVå·ï¼‰
## 4.2 PyTorch æ•™ç¨‹æ¨è
åœŸå †ï¼šBç«™upä¸»â€œæˆ‘æ˜¯åœŸå †â€
## 4.3 æ·±åº¦å­¦ä¹ å®è·µç½‘ç«™æ¨è
1. GitHubï¼ˆå¤šè¯»è¯»åˆ«äººçš„å¼€æºé¡¹ç›®ï¼‰
2. Kaggleï¼ˆå¯¹äºä¸åŒçš„é—®é¢˜ï¼Œå¯ä»¥å¤šå‚è€ƒä¸åŒäººçš„æ€è·¯ä¸ä»£ç ï¼Œèƒ½å¤Ÿå¤§å¤§æé«˜åˆ©ç”¨æ·±åº¦å­¦ä¹ ç†è®ºçŸ¥è¯†ã€PyTorchæ¡†æ¶æ¥è§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›ï¼‰

## 4.4 æ‚è°ˆ
ï¼ˆç•¥ï¼‰