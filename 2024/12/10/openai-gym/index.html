
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <title>OpenAI Gym 的使用 | Cold Rain&#39;s Blog</title>
    <meta name="author" content="冷雨" />
    <meta name="description" content="希望能成为一个厉害的人" />
    <meta name="keywords" content="" />
    <meta
        name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link rel="icon" href="/images/head.jpg" />
    <link rel="preconnect" href="https://s4.zstatic.net" />
<script src="https://s4.zstatic.net/ajax/libs/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.googleapis.cn" />
<link rel="preconnect" href="https://fonts.gstatic.cn" crossorigin />
<link
    rel="stylesheet"
    href="https://fonts.googleapis.cn/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap"
/>
<script> const mixins = {}; </script>

<script src="https://polyfill.alicdn.com/v3/polyfill.min.js?features=default"></script>


<script src="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://s4.zstatic.net/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://s4.zstatic.net/ajax/libs/KaTeX/0.16.9/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>









<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>COLD RAIN&#39;S BLOG</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;主页</span>
        </a>
        
        <a href="/2024/11/26/test">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;简介</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;归档</span>
        </a>
        
        <a href="/categories/RL%EF%BC%88%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%EF%BC%89%E7%90%86%E8%AE%BA%E7%AC%94%E8%AE%B0">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;分类</span>
        </a>
        
        <a href="/tags/RL%EF%BC%88%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%EF%BC%89">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;标签</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;COLD RAIN&#39;S BLOG</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">主页</div>
                    </div>
                </a>
                
                <a href="/2024/11/26/test">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">简介</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">归档</div>
                    </div>
                </a>
                
                <a href="/categories/RL%EF%BC%88%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%EF%BC%89%E7%90%86%E8%AE%BA%E7%AC%94%E8%AE%B0">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">分类</div>
                    </div>
                </a>
                
                <a href="/tags/RL%EF%BC%88%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%EF%BC%89">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">标签</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div class="article">
    <div>
        <h1>OpenAI Gym 的使用</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/12/10
        </span>
        
        <span class="category">
            <a href="/categories/RL%EF%BC%88%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%EF%BC%89%E5%AE%9E%E6%88%98%E7%AC%94%E8%AE%B0/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                RL（强化学习）实战笔记
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            
            <span class="tag">
                
                <a href="/tags/RL%EF%BC%88%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%EF%BC%89/" style="color: #03a9f4">
                    RL（强化学习）
                </a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <blockquote>
<p>OpenAI Gym 是一个能够提供智能体统一 API 以及很多 RL 环境的库。有了它，我们就不需要写大把大把的样板代码了</p>
<p>在这篇文章中，我们会学习如何写下第一个有随机行为的智能体，并借此来进一步熟悉 RL 中的各种概念。在这篇文章结束时，你可能会理解以下内容：</p>
<ul>
<li>将智能体插入 RL 框架所需的高层次要求</li>
<li>基本、纯 Python 实现的随机 RL 智能体</li>
<li>OpenAI Gym</li>
</ul>
</blockquote>
<h2 id="1-剖析智能体"><a href="#1-剖析智能体" class="headerlink" title="1. 剖析智能体"></a>1. 剖析智能体</h2><p>RL 世界中包含许多实体：</p>
<ul>
<li><strong>智能体</strong>：主动行动的人或物。实际上，智能体只是实现了某些策略的代码片段而已。这个策略根据观察决定每个时间点执行什么动作。</li>
<li><strong>环境</strong>：某些世界的模型，它在智能体外部，负责提供观察并给予奖励。而且环境会根据智能体的动作改变自己的状态。</li>
</ul>
<p>接下来，我们来探究如何实现它们。我们先从环境入手，先定义一个环境，限定交互步数，并且不管智能体执行任何动作，它都能给智能体返回随机奖励（先写一个简单的示例）：</p>
<pre><code class="Python">import random
from typing import List

class Environment:
    def __init__(self):
        # 环境初始化的内部状态
        self.step_left = 10
    
    def get_observation(self) -&gt; List[float]:
        # 该方法用于给智能体返回当前环境的观察
        # 这里输出的观察向向量都是0,是因为我们没有给环境任何内部状态
        return [0.0, 0.0, 0.0]

    def get_actions(self) -&gt; List[int]:
        # 该方法允许智能体查询自己能执行的动作集
        # 某些条件下，当环境变化的时候，智能体能执行的动作集也会发生改变
        return [0, 1]

    def is_done(self) -&gt; bool:
        # 给予智能体片段结束的信号
        return self.steps_left == 0

    def action(self, action: int) -&gt; float:
        # 环境的核心功能
        # 它用于处理智能体的动作、返回该动作的奖励、更新已经执行的步数、拒绝执行已执行的片段
        if self.is_done():
            raise Exception(&quot;Game is over!&quot;)
        self.steps_left -= 1
        return random.random()
</code></pre>
<p>接下来我们来看看智能体部分，它更简单，只包含了两个部分：构造函数以及在环境中执行一步的方法：</p>
<pre><code class="Python">class Agent:
    def __init__(self):
        # 初始化计数器，用来保存片段中智能体积累的总奖励
        self.total_reward = 0.0

    def step(self, env: Environment):
        current_oba = env.get_observation()
        actions = env.get_actions()
        reward = env.action(random.choice(actions))
        self.total_reward += reward
</code></pre>
<p>在上面这段代码中，<code>step()</code> 函数接受环境实例作为参数，并允许智能体执行以下操作：</p>
<ul>
<li>观察环境</li>
<li>基于观察决定动作</li>
<li>向环境提交动作</li>
<li>获取当前步骤的奖励</li>
</ul>
<p>对于我们这个例子，智能体比较笨，它在决定执行什么动作的时候会忽略得到的观察。取而代之的是，随机选择动作。下面还有一段胶水代码，它创建两个类并执行一次片段：</p>
<pre><code class="Python">if __name__ == &quot;__main__&quot;:
    env = Environment()
    agent = Agent()

while not env.is_done():
    agent.step(env)

print(&quot;Total reward got: %.4f&quot; % agent.total_reward)
</code></pre>
<p>前面这些简单的代码展示了 RL 模型的重要的基本概念。环境可以是极其复杂的物理模型，智能体也可以轻易地变成一个实现了最新 RL 算法的大型神经网络（NN），但是基本思想还是一致的——每一步，智能体都会从环境中得到观察，进行一番计算，最后选择要执行的动作。这个动作的结果就是奖励和新的观察。</p>
<p>你可能会问，如果基本思想是一样的，为什么还要从头开始实现呢？是否有人已经将其实现为一个通用库了呢？答案是肯定的，这样的框架已经存在了，但是在花时间讨论它们之前，先把你的开发环境准备好吧！</p>
<p>requirements如下所示（⚠️：其中gym版本尽量一致，或者不要用高版本；其他库可用最新版本）：</p>
<pre><code class="Terminal">atari-py==0.2.6
gym==0.15.3
numpy==1.17.2
opencv-python==4.1.1.26
tensorboard==2.0.1
torch==1.3.0
torchvision==0.4.1
pytorch-ignite==0.2.1
tensorboardX==1.9
tensorflow==2.0.0
ptan==0.6
</code></pre>
<h2 id="2-OpenAI-Gym-API"><a href="#2-OpenAI-Gym-API" class="headerlink" title="2. OpenAI Gym API"></a>2. OpenAI Gym API</h2><h3 id="2-1-动作空间"><a href="#2-1-动作空间" class="headerlink" title="2.1 动作空间"></a>2.1 动作空间</h3><h3 id="2-2-观察空间"><a href="#2-2-观察空间" class="headerlink" title="2.2 观察空间"></a>2.2 观察空间</h3><h3 id="2-3-环境"><a href="#2-3-环境" class="headerlink" title="2.3 环境"></a>2.3 环境</h3><h3 id="2-4-创建环境"><a href="#2-4-创建环境" class="headerlink" title="2.4 创建环境"></a>2.4 创建环境</h3><h3 id="2-5-车摆控制"><a href="#2-5-车摆控制" class="headerlink" title="2.5 车摆控制"></a>2.5 车摆控制</h3><p>我们来应用学到的知识探索 Gym 提供的最简单的 RL 环境：</p>
<pre><code class="Python">import gym

e = gym.make(&quot;CartPole-v0&quot;)
</code></pre>

    </div>
    
    
    
    
    
    
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 Cold Rain&#39;s Blog
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;冷雨
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
    




    
</body>
</html>
